(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{603:function(e,t,s){e.exports=s.p+"assets/img/kafka10.7f68bb57.png"},604:function(e,t,s){e.exports=s.p+"assets/img/kafka11.9e9bb201.png"},835:function(e,t,s){"use strict";s.r(t);var a=s(27),r=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"zookeeper-설정"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper-설정"}},[e._v("#")]),e._v(" ZooKeeper 설정")]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("실습 환경")]),e._v(" "),a("ul",[a("li",[e._v("💡 Java10 (Java 8이상 필수)")]),e._v(" "),a("li",[e._v("💡 Windows 10")]),e._v(" "),a("li",[e._v("💡 Git Bash")])]),e._v(" "),a("hr"),e._v(" "),a("p",[e._v("이전 포스팅에서 Kafka를 설치하고 Zookeeper를 실행했는데 Zookeeper가 왜 필요한지, 어떻게 설정하면 되는지 알아보자.")]),e._v(" "),a("h2",{attrs:{id:"_1-zookeeper란"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-zookeeper란"}},[e._v("#")]),e._v(" "),a("strong",[e._v("1. Zookeeper란")])]),e._v(" "),a("p",[e._v("1-1. zookeeper는 Apache의 오픈 소스 프로젝트 중 하나이며, 공개 분산형 구성 서비스, 동기 서비스 및 대용량 분산 시스템을 위한 네임 스페이스 레지스트리를 제공함.")]),e._v(" "),a("p",[e._v("1-2. znode(주키퍼 노드)는 네임 스페이스 안에 데이터를 저장하며, 클라이언트는 znode를 통해 데이터를 읽거나 씀.")]),e._v(" "),a("p",[e._v("1-3. 리더 노드가 존재하며, 리더를 제외한 노드들은 리더로부터 데이터를 동기화함.")]),e._v(" "),a("p",[e._v("1-4. 리더가 장애가 발생하게되면 다른 노드가 리더의 역할을 맡아 안정성이 뛰어남.")]),e._v(" "),a("p",[e._v("1-5. 일반적인 파일 시스템과 달리 zookeeper 데이터는 메모리에 보관되므로 높은 처리량과 낮은 대기 시간을 갖음.")]),e._v(" "),a("p",[a("img",{attrs:{src:s(603),alt:"img"}})]),e._v(" "),a("p",[e._v("Zookeeper 구조: https://zookeeper.apache.org/doc/current/zookeeperOver.html#sc_designGoals")]),e._v(" "),a("p",[a("img",{attrs:{src:s(604),alt:"img"}})]),e._v(" "),a("p",[e._v("Zookeeper의 네임스페이스 구조: https://zookeeper.apache.org/doc/current/zookeeperOver.html#sc_designGoals")]),e._v(" "),a("h2",{attrs:{id:"_2-zookeeper-properties-파일-살펴보기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-zookeeper-properties-파일-살펴보기"}},[e._v("#")]),e._v(" 2. "),a("a",{attrs:{href:"http://zookeeper.properties",target:"_blank",rel:"noopener noreferrer"}},[e._v("zookeeper.properties"),a("OutboundLink")],1),e._v(" 파일 살펴보기")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Licensed to the Apache Software Foundation (ASF) under one or more")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# contributor license agreements.  See the NOTICE file distributed with")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# this work for additional information regarding copyright ownership.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# The ASF licenses this file to You under the Apache License, Version 2.0")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# (the "License"); you may not use this file except in compliance with')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# the License.  You may obtain a copy of the License at")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#    http://www.apache.org/licenses/LICENSE-2.0")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Unless required by applicable law or agreed to in writing, software")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v('# distributed under the License is distributed on an "AS IS" BASIS,')]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# See the License for the specific language governing permissions and")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# limitations under the License.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# the directory where the snapshot is stored.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("dataDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/tmp/zookeeper\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# the port at which the clients will connect")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("clientPort")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2181")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# disable the per-ip limit on the number of connections since this is a non-production config")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("maxClientCnxns")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Disable the adminserver by default to avoid port conflicts.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Set the port to something non-conflicting if choosing to enable this")]),e._v("\nadmin.enableServer"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("false\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# admin.serverPort=8080")]),e._v("\n")])])]),a("p",[e._v("처음 파일을 열어보면 이렇게 되어있다. 위 14 line 까지는 라이선스 관련 내용이다!")]),e._v(" "),a("p",[e._v("그 아래부터 하나씩 살펴보자.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# snapshot 데이터를 저장할 경로를 지정")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("dataDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("C:/dev/kafka_2.13-2.6.0/data/zookeeper\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 클라이언트가 connect할 port 번호 지정")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("clientPort")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2181")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 하나의 클라이언트에서 동시 접속하는 개수 제한, 기본값은 60이며, 0은 무제한")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("maxClientCnxns")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# port 충돌을 방지하려면 admin server 비활성화(false)")]),e._v("\nadmin.enableServer"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("false\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# admin.serverPort=8080")]),e._v("\n")])])]),a("p",[e._v("멀티 서버 설정을 하려면 다음 코드를 추가하면 된다.")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 멀티 서버 설정")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# server.id=host:port:port")]),e._v("\nserver.1"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("localhost:2888:3888\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# server.2=server_host_1:2888:3888")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# server.3=server_host_2:2888:3888")]),e._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 멀티 서버 설정시 각 서버의 dataDir 밑에 myid 파일이 있어야함.")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# echo 1 > myid")]),e._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 리더 서버에 연결해서 동기화하는 시간, [멀티서버옵션]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#initLimit=5")]),e._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 리더 서버를 제외한 노드 서버가 리더와 동기화하는 시간, [멀티서버옵션]")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#syncLimit=2")]),e._v("\n")])])]),a("ul",[a("li",[e._v("필요한 설정은 "),a("a",{attrs:{href:"https://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("공식문서"),a("OutboundLink")],1),e._v("에서 확인하자.")])]),e._v(" "),a("h2",{attrs:{id:"_3-zookeeper-실행하기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-zookeeper-실행하기"}},[e._v("#")]),e._v(" 3. zookeeper 실행하기")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# yj_park@yjpark MINGW64 /c/dev/kafka_2.13-2.6.0")]),e._v("\n$ ./bin/windows/zookeeper-server-start.bat ./config/zookeeper.properties\n")])])]),a("ul",[a("li",[a("code",[e._v("zookeeper-server-start.bat")]),e._v(" 파일은 인자 값으로 "),a("code",[e._v("[zookeeper.properties](http://zookeeper.properties)")]),e._v("를 넘겨주어야 한다.")])]),e._v(" "),a("p",[e._v("zookeeper를 실행하면 위에서 설정한 "),a("strong",[e._v("dataDir")]),e._v(" 경로에 log, snapshot 데이터가 저장되는 것을 확인할 수 있다.")]),e._v(" "),a("p",[e._v("필자는 "),a("code",[e._v("dev")]),e._v(" 폴더에서 관리하고 싶어 경로를 수정했다.")]),e._v(" "),a("p",[e._v("zookeeper는 필요한 설정이 있을 경우 공식문서를 참고해 properties를 추가하는 방식으로 사용하면 될 것 같아 간단히 보고 넘어간다!")]),e._v(" "),a("p",[e._v("이제 kafka server설정을 해보자.")]),e._v(" "),a("hr"),e._v(" "),a("p",[a("strong",[e._v("Reference")])]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://zookeeper.apache.org/doc/r3.3.3/zookeeperAdmin.html"),a("OutboundLink")],1)]),e._v(" "),a("li",[a("a",{attrs:{href:"https://heodolf.tistory.com/10?category=887831",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://heodolf.tistory.com/10?category=887831"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);