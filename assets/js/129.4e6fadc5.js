(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{910:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"resttemplate-정의-특징-urlconnection-httpclient-동작원리-사용법-connection-pool-적용"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#resttemplate-정의-특징-urlconnection-httpclient-동작원리-사용법-connection-pool-적용"}},[t._v("#")]),t._v(" RestTemplate (정의, 특징, URLConnection, HttpClient, 동작원리, 사용법, connection pool 적용)")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://sjh836.tistory.com/141",target:"_blank",rel:"noopener noreferrer"}},[t._v("참조 블로그"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"_1-resttemplate이란"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-resttemplate이란"}},[t._v("#")]),t._v(" 1. RestTemplate이란?")]),t._v(" "),a("p",[t._v("spring 3.0 부터 지원한다. 스프링에서 제공하는 http 통신에 유용하게 쓸 수 있는 템플릿이며, HTTP 서버와의 통신을 단순화하고 RESTful 원칙을 지킨다. jdbcTemplate 처럼 RestTemplate 도 기계적이고 반복적인 코드들을 깔끔하게 정리해준다. 요청보내고 요청받는데 몇줄 안될 정도..")]),t._v(" "),a("h3",{attrs:{id:"특징"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#특징"}},[t._v("#")]),t._v(" 특징")]),t._v(" "),a("ul",[a("li",[t._v("기계적이고 반복적인 코드를 최대한 줄여줌")]),t._v(" "),a("li",[t._v("RESTful형식에 맞춤")]),t._v(" "),a("li",[t._v("json, xml 를 쉽게 응답받음")])]),t._v(" "),a("h2",{attrs:{id:"_2-http-서버와의-다양한-통신방법"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-http-서버와의-다양한-통신방법"}},[t._v("#")]),t._v(" 2. HTTP 서버와의 다양한 통신방법")]),t._v(" "),a("h3",{attrs:{id:"_2-1-urlconnection"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-urlconnection"}},[t._v("#")]),t._v(" 2-1. URLConnection")]),t._v(" "),a("p",[t._v("jdk 1.2 부터 내장되어 있으며, java.net 패키지에 있다. URL의 내용을 읽어오거나, URL 주소에 GET, POST로 데이터를 전달 할 때 사용한다. 또한 http 프로토콜 이외에도 가능하다.(file 등) 보통 아래와 같이 사용한다.")]),t._v(" "),a("ol",[a("li",[t._v('new URL("http:// ....")')]),t._v(" "),a("li",[t._v("openConnection()")]),t._v(" "),a("li",[t._v("URLConnection")]),t._v(" "),a("li",[t._v("getInputStream, getOutputStream")]),t._v(" "),a("li",[t._v("InputStream, OutputStream 처리")])]),t._v(" "),a("h4",{attrs:{id:"_2-1-1-문제점"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-1-문제점"}},[t._v("#")]),t._v(" 2-1-1. 문제점")]),t._v(" "),a("ul",[a("li",[t._v("응답코드가 4xx 거나 5xx 면 IOException 이 터진다.")]),t._v(" "),a("li",[t._v("타임아웃을 설정할 수 없다.")]),t._v(" "),a("li",[t._v("쿠키 제어가 불가")])]),t._v(" "),a("h3",{attrs:{id:"_2-2-httpclient"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-httpclient"}},[t._v("#")]),t._v(" 2-2. HttpClient")]),t._v(" "),a("p",[t._v("3.x일 땐 apache commons 의 프로젝트였다가 승급해서, 아파치 탑 프로젝트가 되었다. 4.x부터는 Apache HttpComponents 로 불린다. maven dependency 를 설정하거나, http://hc.apache.org/downloads.cgi 에서 다운로드할 수 있다. org.apache.http 패키지에 있다.\n보통 아래처럼 사용한다.")]),t._v(" "),a("ol",[a("li",[t._v("CloseableHttpClient httpclient = HttpClients.createDefault();")]),t._v(" "),a("li",[t._v('메소드에 따라 new HttpGet("http:// ....");')]),t._v(" "),a("li",[t._v("CloseableHttpResponse response = httpclient.execute(httpget);")]),t._v(" "),a("li",[t._v("HttpEntity entity = response.getEntity();")]),t._v(" "),a("li",[t._v("Stream으로 entity.getContent() 처리 등")])]),t._v(" "),a("h4",{attrs:{id:"_2-2-1-urlconnection-와-비교하였을-때-장점"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-urlconnection-와-비교하였을-때-장점"}},[t._v("#")]),t._v(" 2-2-1. URLConnection 와 비교하였을 때 장점")]),t._v(" "),a("ul",[a("li",[t._v("모든 응답코드를 읽을 수 있다. httpResponse.getStatusLine().getStatusCode()")]),t._v(" "),a("li",[t._v("타임아웃 설정 가능")]),t._v(" "),a("li",[t._v("쿠키 제어가 가능")])]),t._v(" "),a("h4",{attrs:{id:"_2-2-2-문제점"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-문제점"}},[t._v("#")]),t._v(" 2-2-2. 문제점")]),t._v(" "),a("ul",[a("li",[t._v("URLConnection 을 이용한 방식보다 코드가 간결해졌지만, 여전히 반복적이고 코드들이 길다.")]),t._v(" "),a("li",[t._v("스트림 처리 로직을 별도로 짜야한다. (EntityUtils 를 쓰면 되는거 같긴하지만)")]),t._v(" "),a("li",[t._v("응답의 컨텐츠타입에 따라 별도 로직이 필요하다. (RestTemplate 가 이때 유용!!)")])]),t._v(" "),a("h2",{attrs:{id:"_3-resttemplate-의-동작원리"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-resttemplate-의-동작원리"}},[t._v("#")]),t._v(" 3. RestTemplate 의 동작원리")]),t._v(" "),a("p",[t._v("org.springframework.http.client 패키지에 있다.\nHttpClient는 HTTP를 사용하여 통신하는 범용 라이브러리이고, RestTemplate은 HttpClient 를 추상화(HttpEntity의 json, xml 등)해서 제공해준다.")]),t._v(" "),a("p",[t._v("따라서 내부 통신(HTTP 커넥션)에 있어서는 Apache HttpComponents 를 사용한다. 만약 RestTemplate 가 없었다면, 직접 json, xml 라이브러리를 사용해서 변환해야 했을 것이다.")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/.vuepress/public/images/img-spring/RestTemplate01.png",alt:"img"}})]),t._v(" "),a("ol",[a("li",[t._v("어플리케이션이 RestTemplate를 생성하고, URI, HTTP메소드 등의 헤더를 담아 요청한다.")]),t._v(" "),a("li",[t._v("RestTemplate 는 HttpMessageConverter 를 사용하여 requestEntity 를 요청메세지로 변환한다.")]),t._v(" "),a("li",[t._v("RestTemplate 는 ClientHttpRequestFactory 로 부터 ClientHttpRequest 를 가져와서 요청을 보낸다.")]),t._v(" "),a("li",[t._v("ClientHttpRequest 는 요청메세지를 만들어 HTTP 프로토콜을 통해 서버와 통신한다.")]),t._v(" "),a("li",[t._v("RestTemplate 는 ResponseErrorHandler 로 오류를 확인하고 있다면 처리로직을 태운다.")]),t._v(" "),a("li",[t._v("ResponseErrorHandler 는 오류가 있다면 ClientHttpResponse 에서 응답데이터를 가져와서 처리한다.")]),t._v(" "),a("li",[t._v("RestTemplate 는 HttpMessageConverter 를 이용해서 응답메세지를 java object(Class responseType) 로 변환한다.")]),t._v(" "),a("li",[t._v("어플리케이션에 반환된다.")])]),t._v(" "),a("h2",{attrs:{id:"_4-resttemplate-를-써보자"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-resttemplate-를-써보자"}},[t._v("#")]),t._v(" 4. RestTemplate 를 써보자")]),t._v(" "),a("h3",{attrs:{id:"_4-1-생성하기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-생성하기"}},[t._v("#")]),t._v(" 4-1. 생성하기")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("기본 생성 : RestTemplate restTemplate = getRestTempalte();")])]),t._v(" "),a("li",[a("p",[t._v("설정 생성 :")])])]),t._v(" "),a("div",{staticClass:"language-Java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpComponentsClientHttpRequestFactory")]),t._v(" factory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpComponentsClientHttpRequestFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setReadTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 읽기시간초과, ms")]),t._v("\n  factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConnectTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 연결시간초과, ms")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClient")]),t._v(" httpClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClientBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMaxConnTotal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connection pool 적용")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMaxConnPerRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connection pool 적용")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHttpClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("httpClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 동기실행에 사용될 HttpClient 세팅 ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),t._v(" restTemplate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"connection-pool-적용"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connection-pool-적용"}},[t._v("#")]),t._v(" connection pool 적용")]),t._v(" "),a("p",[t._v("참조문서 : https://stackoverflow.com/questions/31869193/using-spring-rest-template-either-creating-too-many-connections-or-slow/")]),t._v(" "),a("p",[t._v("언젠가 만날 것 같아서 기록.. RestTemplate 은 기본적으로 connection pool 을 사용하지 않는다.\n따라서 연결할 때 마다, 로컬 포트를 열고 tcp connection 을 맺는다. 이때 문제는 close() 이후에 사용된 소켓은 TIME_WAIT 상태가 되는데, 요청량이 많다면 이런 소켓들을 재사용하지 못하고 소켓이 오링나서 응답이 지연될 것이다.")]),t._v(" "),a("p",[t._v("이런 경우 connection pool 을 사용해서 해결할 수 있는데, DBCP마냥 소켓의 갯수를 정해서 재사용하는 것이다. RestTemplate 에서 connection pool 을 적용하려면, 위와 같이 HttpClient 를 만들고 setHttpClient() 를 해야한다.")]),t._v(" "),a("ul",[a("li",[t._v("setMaxConnPerRoute : IP,포트 1쌍에 대해 수행 할 연결 수를 제한한다.")]),t._v(" "),a("li",[t._v("setMaxConnTotal : 최대 오픈되는 커넥션 수를 제한한다.")])]),t._v(" "),a("h3",{attrs:{id:"_4-2-사용하기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-사용하기"}},[t._v("#")]),t._v(" 4-2. 사용하기")]),t._v(" "),a("h4",{attrs:{id:"주요-메소드"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#주요-메소드"}},[t._v("#")]),t._v(" 주요 메소드")]),t._v(" "),a("p",[a("img",{attrs:{src:"/docs/.vuepress/public/images/img-spring/RestTemplateMethod.png",alt:"img"}})]),t._v(" "),a("h4",{attrs:{id:"요청할-url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#요청할-url"}},[t._v("#")]),t._v(" 요청할 URL")]),t._v(" "),a("p",[t._v("다양한 방법이 있다.")]),t._v(" "),a("ul",[a("li",[t._v("UriComponentsBuilder 로 파라미터를 붙이거나 String.format 로 붙이거나 등등")]),t._v(" "),a("li",[t._v('(/user/{id}, ... , "redboy") 처럼 rest하게 넘길 수도 있다.')]),t._v(" "),a("li",[t._v("map 을 이용해서 더 깔끔하게 할 수도 있다.")])]),t._v(" "),a("h4",{attrs:{id:"object-로-받기"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#object-로-받기"}},[t._v("#")]),t._v(" Object 로 받기")]),t._v(" "),a("p",[t._v("ForObject 를 사용할때, 응답 xml이나 json 에 맞는 java object(Class responseType)가 필요하다. @XmlElement 를 사용하거나 @JsonProperty 등을 사용하여 매핑해줘야한다.")]),t._v(" "),a("h4",{attrs:{id:"에러-처리"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#에러-처리"}},[t._v("#")]),t._v(" 에러 처리")]),t._v(" "),a("p",[t._v("DefaultResponseErrorHandler를 사용하여 HTTP Error 를 제어한다. restTemplate.setErrorHandler 를 통해 커스텀 핸들러를 등록할 수 있다.")]),t._v(" "),a("h4",{attrs:{id:"비동기-처리"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#비동기-처리"}},[t._v("#")]),t._v(" 비동기 처리")]),t._v(" "),a("p",[t._v("RestTemplate 는 동기처리에 사용된다. 비동기 처리는 org.springframework.web.client.AsyncRestTemplate 를 사용해야 한다. 언젠가 쓸 일이 오겠지..")]),t._v(" "),a("h2",{attrs:{id:"_5-예제"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-예제"}},[t._v("#")]),t._v(" 5. 예제")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("impl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClientBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpComponentsClientHttpRequestFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")])]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplateEx")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpComponentsClientHttpRequestFactory")]),t._v(" factory "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpComponentsClientHttpRequestFactory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setReadTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 읽기시간초과, ms")]),t._v("\n        factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConnectTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 연결시간초과, ms")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClient")]),t._v(" httpClient "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HttpClientBuilder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMaxConnTotal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connection pool 적용")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setMaxConnPerRoute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connection pool 적용")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHttpClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("httpClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 동기실행에 사용될 HttpClient 세팅")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),t._v(" restTemplate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RestTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://testapi.com/search?text=1234"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 예제니까 애초에 때려박음..")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" restTemplate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getForObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"요청할 URI 주소"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"응답내용과 자동으로 매핑시킬 java object"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reference"}},[t._v("#")]),t._v(" Reference")]),t._v(" "),a("ul",[a("li",[t._v("https://sjh836.tistory.com/141")]),t._v(" "),a("li",[t._v("https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html")])])])}),[],!1,null,null,null);s.default=e.exports}}]);