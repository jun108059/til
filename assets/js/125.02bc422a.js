(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{772:function(t,a,s){"use strict";s.r(a);var n=s(12),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"db-á„‡á…©á†¨á„Œá…¦-á„Œá…µá„‹á…§á†«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#db-á„‡á…©á†¨á„Œá…¦-á„Œá…µá„‹á…§á†«"}},[t._v("#")]),t._v(" DB ë³µì œ ì§€ì—°")]),t._v(" "),a("ul",[a("li",[t._v("Main-Replica êµ¬ì¡°ì—ì„œ ë°œìƒ")]),t._v(" "),a("li",[t._v("Main DB(Write DB)ì—ì„œ ë°ì´í„° ë³€ê²½ì´ ì¼ì–´ë‚œ í›„, Replica DB(Read DB)ë¡œì˜ ë³µì œê°€ ì¦‰ì‹œ ì´ë£¨ì–´ì§€ì§€ ì•ŠëŠ” ê²½ìš°ë¥¼ "),a("code",[t._v("ë³µì œê°€ ì§€ì—°ëë‹¤")]),t._v("ê³  í‘œí˜„í•¨")]),t._v(" "),a("li",[t._v("ì´ëŸ° ì§€ì—°ì´ ìƒê¸°ëŠ” ë™ì•ˆì— ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì´ Replica DBë¥¼ ì¡°íšŒí•˜ë©´ ì•„ì§ ë°˜ì˜ë˜ì§€ ì•Šì€ ì˜ˆì „ ë°ì´í„° ì¡°íšŒ")])]),t._v(" "),a("h2",{attrs:{id:"á„‰á…µá„‚á…¡á„…á…µá„‹á…©"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#á„‰á…µá„‚á…¡á„…á…µá„‹á…©"}},[t._v("#")]),t._v(" ì‹œë‚˜ë¦¬ì˜¤")]),t._v(" "),a("div",{staticClass:"language-kotlin extra-class"},[a("pre",{pre:!0,attrs:{class:"language-kotlin"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ì‚¬ìš©ìì˜ ê³„ì • ì”ì•¡ì„ ì¦ê°€ì‹œí‚¤ëŠ” ë¡œì§")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fun")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increaseBalance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" amount"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Int"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. Main DBì— ì‚¬ìš©ì ì”ì•¡ ì¦ê°€ ë°˜ì˜")]),t._v("\n    userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increaseBalance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. ì´ë²¤íŠ¸ë¥¼ ìƒì„±í•˜ì—¬ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì— ì”ì•¡ ë³€ê²½ì„ ì•Œë¦¼")]),t._v("\n    eventPublisher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("publishBalanceIncreasedEvent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" amount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. í˜„ì¬ ì”ì•¡ì„ Replica DBì—ì„œ ì¡°íšŒ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" currentBalance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBalance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4. í˜„ì¬ ì”ì•¡ì´ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ ë³´ë„ˆìŠ¤ ì§€ê¸‰")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentBalance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        bonusService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("grantBonus")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("ë³µì œ ì§€ì—°ì´ ë°œìƒí•˜ë©´, 3ë²ˆ Replica DBì—ì„œ ì”ì•¡ì´ 10,000ì› ì´ìƒ ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒí–ˆì§€ë§Œ 1ë²ˆì˜ Main DBì— ì”ì•¡ ì¦ê°€ê°€ ë°˜ì˜ë˜ê¸° ì „ ë°ì´í„°ë¥¼ ì½ì–´ì˜¤ê¸° ë•Œë¬¸ì— ë³´ë„ˆìŠ¤ê°€ ì§€ê¸‰ë˜ì§€ ì•ŠëŠ”ë‹¤.")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://github.com/jun108059/til/assets/42997924/7f5b1ad6-3efa-494a-90d7-ff3364a24590",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#á„’á…¢á„€á…§á†¯-á„‡á…¡á†¼á„‡á…¥á†¸"}},[t._v("#")]),t._v(" í•´ê²° ë°©ë²•")]),t._v(" "),a("h3",{attrs:{id:"_1-maindb-á„‹á…µá†°á„€á…µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-maindb-á„‹á…µá†°á„€á…µ"}},[t._v("#")]),t._v(" 1. MainDB ì½ê¸°")]),t._v(" "),a("ul",[a("li",[t._v("í•´ë‹¹ ë¡œì§ì—ì„œëŠ” insert-selectë¥¼ ë™ì¼í•œ MainDBì— queryí•˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.")]),t._v(" "),a("li",[t._v("ë‹¨ì ì€ Main DBì— ë¶€í•˜ê°€ ë°œìƒí•œë‹¤")])]),t._v(" "),a("h3",{attrs:{id:"_2-á„…á…©á„Œá…µá†¨-á„‰á…¥á†¯á„€á…¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-á„…á…©á„Œá…µá†¨-á„‰á…¥á†¯á„€á…¨"}},[t._v("#")]),t._v(" 2. ë¡œì§ ì„¤ê³„")]),t._v(" "),a("ul",[a("li",[t._v("ë¡œì§ì„ ì„¤ê³„í•  ë•Œ, ë³µì œ ì§€ì—° ê°€ëŠ¥ì„±ì„ ê³ ë ¤í•˜ì—¬ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•´ë„ ì‹œìŠ¤í…œì´ ì œëŒ€ë¡œ ë™ì‘í•˜ë„ë¡ ì„¤ê³„")]),t._v(" "),a("li",[t._v("ex) insert í›„ ì˜ë„ì ìœ¼ë¡œ ì§€ì—°ì‹œê°„ì„ ë‘ì–´, ë³µì œê°€ ì™„ë£Œëœ ì´í›„ì— select í•œë‹¤")])]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ¤” ì´ë ‡ê²Œ ë¡œì§ì„ ì„¤ê³„í•˜ë ¤ë©´ ë¡œì§ ì²˜ë¦¬ ì§€ì—° ì‹œê°„ì„ ì–¼ë§ˆë‚˜ ë‘¬ì•¼ ë˜ëŠ”ì§€, ë³µì œ ì§€ì—°ì´ ì–¼ë§ˆë‚˜ ê¸¸ê²Œ ë°œìƒí•˜ëŠ”ì§€ ì•Œì•„ì•¼ë˜ëŠ”ë° ì–´ë–»ê²Œ íŒŒì•…í• ê¹Œ?")])]),t._v(" "),a("h4",{attrs:{id:"á„‡á…©á†¨á„Œá…¦-á„Œá…µá„‹á…§á†«-á„‰á…µá„€á…¡á†«-á„†á…©á„‚á…µá„á…¥á„…á…µá†¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#á„‡á…©á†¨á„Œá…¦-á„Œá…µá„‹á…§á†«-á„‰á…µá„€á…¡á†«-á„†á…©á„‚á…µá„á…¥á„…á…µá†¼"}},[t._v("#")]),t._v(" ë³µì œ ì§€ì—° ì‹œê°„ ëª¨ë‹ˆí„°ë§")]),t._v(" "),a("ul",[a("li",[t._v("DB ë³µì œ ì§€ì—° ëª¨ë‹ˆí„°ë§ ë°©ë²•ì€ Grafana, Prometheus, Datadog ë“±ì˜ ì†”ë£¨ì…˜ì„ í†µí•´ ì‹œê°í™”í•˜ê³  alertë„ ì—°ë™í•  ìˆ˜ ìˆë‹¤!")]),t._v(" "),a("li",[t._v('ì•„ë˜ ê·¸ë˜í”„ë¥¼ ë³´ë©´, ë³µì œ ì§€ì—° ì‹œê°„ì„ yì¶• "ì´ˆ"ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.')])]),t._v(" "),a("img",{attrs:{width:"755",alt:"image",src:"https://github.com/jun108059/til/assets/42997924/0ffb4126-e764-42d2-8c6e-1d1f48a63246"}}),t._v(" "),a("h3",{attrs:{id:"_3-á„‡á…®á†«á„‰á…¡á†«-á„á…³á„…á…¢á†«á„Œá…¢á†¨á„‰á…§á†«á„‹á…³á†¯-á„á…©á†¼á„’á…¡á†«-á„ƒá…¦á„‹á…µá„á…¥-á„‹á…µá†¯á„€á…ªá†«á„‰á…¥á†¼-á„‹á…²á„Œá…µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-á„‡á…®á†«á„‰á…¡á†«-á„á…³á„…á…¢á†«á„Œá…¢á†¨á„‰á…§á†«á„‹á…³á†¯-á„á…©á†¼á„’á…¡á†«-á„ƒá…¦á„‹á…µá„á…¥-á„‹á…µá†¯á„€á…ªá†«á„‰á…¥á†¼-á„‹á…²á„Œá…µ"}},[t._v("#")]),t._v(" 3. ë¶„ì‚° íŠ¸ëœì­ì…˜ì„ í†µí•œ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€")]),t._v(" "),a("ul",[a("li",[t._v("ë¶„ì‚° íŠ¸ëœì­ì…˜(Distributed Transaction)ì€ ì—¬ëŸ¬ ì‹œìŠ¤í…œ ê°„ì— ë°ì´í„°ì˜ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ì´ë‹¤")]),t._v(" "),a("li",[t._v("ê° ì‹œìŠ¤í…œì´ ê°œë³„ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ëŠ” ëŒ€ì‹ , ì—¬ëŸ¬ ì‹œìŠ¤í…œì´ ì°¸ì—¬í•˜ëŠ” ì „ì²´ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•˜ì—¬ ëª¨ë“  ì‹œìŠ¤í…œì˜ ë°ì´í„° ìƒíƒœë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•˜ë ¤ëŠ” ëª©ì ì´ ìˆë‹¤")]),t._v(" "),a("li",[t._v("2ë‹¨ê³„ ì»¤ë°‹(2-Phase Commit)ê³¼ 3ë‹¨ê³„ ì»¤ë°‹(3-Phase Commit), ì‚¬ê°€ íŒ¨í„´(Saga Pattern) ë“±ì´ ë¶„ì‚° íŠ¸ëœì­ì…˜ì„ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ëŒ€í‘œì ì¸ ì•Œê³ ë¦¬ì¦˜ê³¼ íŒ¨í„´ì´ë‹¤")]),t._v(" "),a("li",[t._v("ìì„¸íˆ ë‹¤ë£¨ê¸°ëŠ” ë‚´ìš©ì´ ë§ê¸° ë•Œë¬¸ì— ì´í›„ì— ë”°ë¡œ ì •ë¦¬í•  ì˜ˆì •ì´ë‹¤")])])])}),[],!1,null,null,null);a.default=e.exports}}]);