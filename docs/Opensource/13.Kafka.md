# Kafka Quick Start

ì‹¤ìŠµ í™˜ê²½

- ğŸ’¡ Java10 (Java 8ì´ìƒ í•„ìˆ˜)
- ğŸ’¡ Windows 10
- ğŸ’¡ Git Bash
- ğŸ’¡ Kafka 2.6.0

---

ì•ì„œ ê°„ë‹¨í•œ properties ì„¤ì •ë„ ëª¨ë‘ ì‚´í´ë³´ì•˜ê³  ì‹¤í–‰í•˜ëŠ” ë°©ë²•ë„ ì•Œì•„ë³´ì•˜ë‹¤.

ì´ì œ [APACHE KAFKA QUICKSTART ê³µì‹ë¬¸ì„œ](https://kafka.apache.org/quickstart)ë¥¼ ë”°ë¼ Kafka ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë³´ì.

## 1. ë¹ ë¥´ê²Œ zookeeper, kafka server ì‹¤í–‰

```python
# yj_park@yjpark MINGW64 /c/dev/kafka_2.13-2.6.0

# zookeeper ì‹¤í–‰
$ bin/windows/zookeeper-server-start.bat config/zookeeper.properties

# kafka server ì‹¤í–‰
$ bin/windows/kafka-server-start.bat config/server.properties
```

## 2. Topic ìƒì„±í•˜ê¸°

ìš©ì–´ëŠ” ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ì‚´í´ë³´ì•˜ìœ¼ë‹ˆ ê°„ë‹¨í•œ ì›ë¦¬ë§Œ ì‚´í´ë³´ì.

- KafkaëŠ” ì´ë²¤íŠ¸(ë˜ëŠ” ë©”ì‹œì§€)ë¥¼ ì½ê³ , ì“°ê³ , ì €ì¥í•˜ê³ , ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” ë¶„ì‚° ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼
- ì´ë²¤íŠ¸ ì˜ˆì‹œ(ë°°ì†¡ ì£¼ë¬¸, ì„¼ì„œ, ê²°ì œ  ì²˜ë¦¬, App Push ì•Œë¦¼, ë©”ì¼ ë³´ë‚´ê¸° ë“±)
- ì´ëŸ° ì´ë²¤íŠ¸ë¥¼ Topic ë³„ë¡œ  êµ¬ì„± ë° ì €ì¥!

> ê°„ë‹¨í•œ Topicì€ íŒŒì¼ ì‹œìŠ¤í…œì˜ í´ë”, EventëŠ” íŒŒì¼ë¡œ ì´í•´í•˜ë©´ í¸í•˜ë‹¤.
ê·¸ëŸ¬ë‹ˆ, Event(íŒŒì¼) ìƒì„± ì „ì— Topic(í´ë”)ì„ ë¨¼ì € ìƒì„±í•´ë³´ì.ğŸ˜Š

```bash
# yj_park@yjpark MINGW64 /c/dev/kafka_2.13-2.6.0
$ .\bin\windows\kafka-topics.bat --create --topic quickstart-events --bootstrap-server localhost:9092
```

1. **--create**
    - ìƒˆë¡œìš´ í† í”½ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜
2. **--topic**
    - create, alter, describe, delete ì˜µì…˜ì— ì‚¬ìš©í•  Topic ëª…
    - Topic ì´ë¦„ì€ í°ë”°ì˜´í‘œ(")ë¡œ ë¬¶ì„ ìˆ˜ ìˆê³ , ì •ê·œì‹ ì‚¬ìš©ì´ ê°€ëŠ¥( \ë¡œ escape)
3. **--bootstrap-server**
    - ì—°ê²°í•  KafkaÂ ì„œë²„( host:port )
    - ì´ ì˜µì…˜ì´ ì¶”ê°€ë˜ë©´, ì§ì ‘ Zookeeperì— ì—°ê²°í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
4. (ì¶”ê°€ì˜µì…˜) -**-replication-factor**
    - Partition ë³µì œ ìˆ˜
    - ê¸°ë³¸ ê°’ì€ server.properties íŒŒì¼ì—ì„œÂ default.replication.factorÂ í•­ëª©ìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥( ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šì„ ê²½ìš°, ì¶”ê°€ ì‘ì„±)
5. (ì¶”ê°€ì˜µì…˜) **--partitions**
    - Topicì´ ìƒì„±ë˜ê±°ë‚˜ ë³€ê²½ë  ë•Œì˜ Partition ìˆ˜
    - ê¸°ë³¸ ê°’ì€ server.properties íŒŒì¼ì—ì„œÂ num.partitionsÂ í•­ëª©ìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥

### 2-1. Topic ìƒì„± ì˜µì…˜ í™•ì¸í•˜ê¸°

`--help ì˜µì…˜`

ë” ìì„¸í•œ Topic ê´€ë ¨ ì˜µì…˜ì„ í™•ì¸í•˜ë ¤ë©´ **help ëª…ë ¹ì–´**ë¥¼ ì…ë ¥í•´ë³´ì.

```bash
# yj_park@yjpark MINGW64 /c/dev/kafka_2.13-2.6.0
$ .\bin\windows\kafka-topics.bat --help
```

### 2-2. í˜„ì¬ ì‚¬ìš© ì •ë³´ í™•ì¸í•˜ê¸°

`--describe ì˜µì…˜`

- ìƒˆë¡œìš´ Topicì˜ PartitionCountì™€ ê°™ì€ ì„¸ë¶€ ì •ë³´ í‘œì‹œí•˜ëŠ” ì˜ˆì‹œ

```bash
$ .\bin\windows\kafka-topics.bat --describe --topic quickstart-events --bootstrap-server localhost:9092
Topic:quickstart-events  PartitionCount:1    ReplicationFactor:1 Configs:
    Topic: quickstart-events Partition: 0    Leader: 0   Replicas: 0 Isr: 0
```

### 2-3. Topic ëª©ë¡ í™•ì¸í•˜ê¸°

`--list ì˜µì…˜`

- ì‚¬ìš© ê°€ëŠ¥í•œ Topic ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```bash
$ .\bin\windows\kafka-topics.bat --list --bootstrap-server localhost:9092
```

### 2-4. Topic ì‚­ì œí•˜ê¸°

`--delete ì˜µì…˜`

- Topicì„ ì‚­ì œí•˜ë ¤ë©´ **server.properties** íŒŒì¼ì—ì„œ **delete.topic.enable=true** ì„¤ì •ì„ ì¶”ê°€í•´ì¤˜ì•¼ í•œë‹¤. (ì„œë²„ ì¬ì‹œì‘ í•„ìš”)

```bash
$ .\bin\windows\kafka-topics.bat --delete --topic quickstart-events --bootstrap-server localhost:9092
```

## 3. Producer

### 3-1. Event(ë©”ì‹œì§€) ìƒì„±í•˜ê¸°

Topicì„ ìƒì„±í–ˆìœ¼ë‹ˆ Eventë¥¼ ë§Œë“¤ì–´ë³´ì!

- Kafka í´ë¼ì´ì–¸íŠ¸ëŠ” Eventë¥¼ ì½ê±°ë‚˜ ì“¸ ë•Œ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ Kafka Brokerì™€ í†µì‹ í•œë‹¤.
- Eventê°€ ìˆ˜ì‹ ë˜ë©´ BrokerëŠ” Eventë¥¼ ì €ì¥

ProducerëŠ” Kafka Queueì— ì •ë³´ë¥¼ ì €ì¥í•´ì¤€ë‹¤.
Message(= Event)ë¥¼ ë§Œë“¤ì–´ì„œ Topicìœ¼ë¡œ ë³´ë‚´ë³´ì.

> BrokerëŠ” Kafka ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì„¤ì¹˜ë˜ì–´ ìˆëŠ” ì„œë²„ ë˜ëŠ” ë…¸ë“œì´ë‹¤.

```bash
$ .\bin\windows\kafka-console-producer.bat --topic quickstart-events --bootstrap-server localhost:9092 
> This is my first event
> jun108059
```

- ë©”ì‹œì§€ ë‘ê°œê°€ ìƒì„±ëë‹¤.
- ì¢…ë£Œí•˜ë ¤ë©´ **ctrl + c** ë¥¼ ëˆ„ë¥´ë©´ ëœë‹¤.

### 3-2. Producer ê´€ë ¨ ì˜µì…˜ í•œë²ˆì— ë³´ê¸°

`--help ì˜µì…˜`

```bash
$ .\bin\windows\kafka-console-producer.bat --help
```

## 4. Consumer

### 4-1. Event(ë©”ì‹œì§€) ì½ê¸°(ì†Œë¹„í•˜ê¸°)

- ìƒì„±ëœ ë©”ì‹œì§€ë¥¼ ì˜µì…˜ì„ í†µí•´ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì†Œë¹„í•  ìˆ˜ ìˆë‹¤.

```bash
$ .\bin\windows\kafka-console-consumer.bat --topic quickstart-events --from-beginning --bootstrap-server localhost:9092 
This is my first event
jun108059
```

`--from-beginning ì˜µì…˜`

- Consumerì—ê²Œ ì„¤ì •ëœ offsetì´ ì—†ìœ¼ë¯€ë¡œ ê°€ì¥ ìµœì‹ ì˜ ë©”ì‹œì§€ ëŒ€ì‹  ê°€ì¥ ë¨¼ì € ë„ì°©í•œ ë©”ì‹œì§€ë¶€í„° ì½ë„ë¡ í•˜ëŠ” ì˜µì…˜

### 4-2. Consumer ê´€ë ¨ ì˜µì…˜ í•œë²ˆì— ë³´ê¸°

`--help ì˜µì…˜`

```bash
$ .\bin\windows\kafka-console-consumer.bat --help
```

Kafkaì—ì„œ ê°„ë‹¨í•˜ê²Œ Topicì„ ë§Œë“¤ê³  Eventë¥¼ ìƒì„±í•˜ê³  ì†Œë¹„í•´ë³´ì•˜ë‹¤.

ì´ì œ Spring bootì— ì—°ë™í•´ì„œ Kafkaë¥¼ ì‚¬ìš©í•˜ëŠ” í¬ìŠ¤íŒ…ì„ í•  ì˜ˆì •ì´ë‹¤.

**Reference**

- [https://kafka.apache.org/quickstart](https://kafka.apache.org/quickstart)
- [https://kafka.apache.org/documentation/#configuration](https://kafka.apache.org/documentation/#configuration)
- [https://victorydntmd.tistory.com/345](https://victorydntmd.tistory.com/345)