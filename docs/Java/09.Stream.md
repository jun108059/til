# Stream

## 1. Stream ì†Œê°œ

> ì—°ì†ëœ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜¤í¼ë ˆì´ì…˜ë“¤ì˜ ëª¨ìŒ

<img src = "https://user-images.githubusercontent.com/42997924/140324289-8529f61a-5c59-42aa-8075-2a92412b2960.gif" width="50%" height="50%">

ğŸ”¼ [ì´ë¯¸ì§€ ì¶œì²˜](https://weibo.com/2856003072/JnaSbeEnJ?type=comment)

- `stream` ì€ `ì»¨ë² ì´ì–´ ë²¨íŠ¸`ì™€ ë¹„ìŠ·í•˜ë‹¤.
- ì»¨ë² ì´ì–´ ë²¨íŠ¸ì— ë–¡ì¡°ê°(ë°ì´í„°)ë“¤ì„ í˜ë ¤ë³´ë‚´ë©´ì„œ ë°˜ì£½ì„ í•˜ê³ , ì•™ê¸ˆì„ ìŒ“ê³  (map),  ë¶ˆëŸ‰í’ˆì€ ë¹¼ê³ (filter) í¬ì¥ì„ í•´ì„œ(collect) ë‚´ë³´ë‚¸ë‹¤.

### 1-1. Streamì˜ íŠ¹ì§•

1. ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ” ì €ì¥ì†Œ(ì»¬ë ‰ì…˜)ì´ ì•„ë‹ˆë‹¤.
2. Functional in nature. 
  - streamì€ ì²˜ë¦¬í•˜ëŠ” ë°ì´í„° ì†ŒìŠ¤ë¥¼ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤. 
  - ì¦‰ ë‚´ê°€ `A`ë¼ëŠ” ë°ì´í„°ë¥¼ ìˆ˜ì •í•œë‹¤ê³  í•´ì„œ ì›ë³¸ë°ì´í„°ê°€ ìˆ˜ì •ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ì˜ë¯¸!

```java
public static void main(String[] args) {
    List<String> names = new ArrayList<>();
    names.add("yj");

    Stream<String> stringStream = names.stream().map(String::toUpperCase);
    names.forEach(System.out::println);
}

/*
[ì‹¤í–‰ ê²°ê³¼]
yj
*/
```

3. ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°ì´í„°ëŠ” ì˜¤ì§ í•œ ë²ˆë§Œ ì²˜ë¦¬í•œë‹¤.
   - ì»¨ë² ì´ì–´ ë²¨íŠ¸ì—ì„œ ë°ì´í„°ë“¤ì´ í•œ ë²ˆ ì§€ë‚˜ê°„ë’¤ ë‹¤ì‹œ ëŒì•„ì˜¤ì§€ ì•ŠìŒ.
     
4. ë¬´ì œí•œì˜ ë°ì´í„°ì¼ìˆ˜ë„ ìˆë‹¤.
   - ì´ ê²½ìš° Short Circuit ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

5. ì¤‘ê°œ ì˜¤í¼ë ˆì´ì…˜ì€ ê·¼ë³¸ì ìœ¼ë¡œ `lazy`í•˜ë‹¤. 
   - ì—¬ëŸ¬ ì¤‘ê°œ ì˜¤í¼ë ˆì´ì…˜ë“¤ì„ ë©”ì†Œë“œ ì²´ì´ë‹ì„ í•˜ë”ë¼ë„ ê·¸ ì‹œì ì—ì„œ ì½”ë“œê°€ ìˆ˜í–‰ë˜ì§€ëŠ” ì•ŠìŒ. 
   - ëª¨ë“  ì¤‘ê°œ ì˜¤í¼ë ˆì´ì…˜ì˜ ì‹¤í–‰ ì‹œê¸°ëŠ” ì¢…ë£Œ ì˜¤í¼ë ˆì´ì…˜ì˜ í˜¸ì¶œì‹œì !
   - ë”°ë¼ì„œ ì¤‘ê°œ ì˜¤í¼ë ˆì´ì…˜ì˜ ë°˜í™˜íƒ€ì…ì€ ë˜ ë‹¤ë¥¸ stream
```java
public static void main(String[] args) {
    List<String> names = new ArrayList<>();
    names.add("yj");
    names.add("youngjun");
    names.add("spring");
    names.add("java8");

    Stream<String> stringStream = names.stream().map(s->{
        System.out.println(s);
        return s.toUpperCase();
    });
    names.forEach(System.out::println);
}
```
    
- `names.stream().map(s->{ ... });`
    - streamì˜ ì¤‘ê°œì˜¤í¼ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ìˆœê°„ì—ëŠ” ì½”ë“œê°€ ìˆ˜í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì¤‘ê°œì˜¤í¼ë ˆì´ì…˜ map ì•ˆì— ìˆëŠ” ì¶œë ¥ë¬¸ì´ ìˆ˜í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.  ìˆ˜í–‰ì‹œí‚¤ê¸°ìœ„í•´ì„œëŠ” ìŠ¤íŠ¸ë¦¼ íŒŒì´í”„ë¼ì¸ì„ ì •ì˜í•´ì•¼í•©ë‹ˆë‹¤.

6. ì†ì‰½ê²Œ ë³‘ë ¬ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.
   - ì§€ê¸ˆê» êµ¬í˜„í•œ ëŒ€ë¶€ë¶„ì˜ ì˜ˆì œì½”ë“œì—ì„œëŠ” forEachë¥¼ í†µí•´ ë‹¨ìˆœí•œ ë°˜ë³µ ì¶œë ¥í–ˆë‹¤.
   - ê·¸ëŸ°ë° ì—¬ê¸°ì„œ ì¡°ê±´ë¬¸ì´ ì¶”ê°€ë˜ê³  ë¡œì§ì´ ì¶”ê°€ë ìˆ˜ë¡ streamì„ í†µí•´ êµ¬í˜„í• ìˆ˜ë¡ ê°„ê²°í•´ì§€ê¸° ë•Œë¬¸ì— streamì„ ì“°ëŠ” ê²ƒ ì™¸ì—ë„ ê¸°ë³¸ì ì¸ forë¬¸ì´ë‚˜ for-ofë¬¸ìœ¼ë¡œëŠ” ë¡œì§ë“¤ì„ ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ì‰½ì§€ ì•Šë‹¤. 
   - í•˜ì§€ë§Œ, parallelStream()ì„ ì´ìš©í•˜ë©´ ì†ì‰½ê²Œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.

```java
public static void main(String[] args) {
    List<String> names = new ArrayList<>();
    names.add("yj");
    names.add("youngjun");
    names.add("spring");
    names.add("java8");

    List<String> collect = names.parallelStream().map(s->{
        System.out.println(s + " " + Thread.currentThread().getName());
        return s.toUpperCase();
    }).collect(Collectors.toList());

    collect.forEach(System.out::println);
}
```
- `ì£¼ì˜í•  ì `
  - ì‚¬ì‹¤ìƒ ë©€í‹° ìŠ¤ë ˆë“œë¥¼ ì´ìš©í•œë‹¤ê³  ì„±ëŠ¥ì´ ë¬´ì¡°ê±´ ì¢‹ì€ ê²ƒì€ ì•„ë‹ˆë©° ì˜¤íˆë ¤ ëŠë ¤ì§ˆ ê°€ëŠ¥ì„±ì´ ë” ë†’ë‹¤. 
  - ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ê·¸ëƒ¥ `stream`ì„ ì“°ëŠ”ê²Œ ë‚˜ìœ¼ë©° ì •ë§ í°ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í›„ `parallelStream()`ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.
  
## 2. ìŠ¤íŠ¸ë¦¼ íŒŒì´í”„ë¼ì¸

> ìŠ¤íŠ¸ë¦¼ì´ë¼ëŠ” ì»¨ë² ì´ì–´ ë²¨íŠ¸ì— 0ê°œ í˜¹ì€ ë‹¤ìˆ˜ì˜ ì¤‘ê°œ ì˜¤í¼ë ˆì´í„°(intermediate operation)ê³¼ í•œê°œì˜ ì¢…ë£Œ ì˜¤í¼ë ˆì´ì…˜(terminal operation)ìœ¼ë¡œ êµ¬ì„±. ì´ ìŠ¤íŠ¸ë¦¼ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ ì¢…ë£Œ ì˜¤í¼ë ˆì´ì…˜ì´ ìˆì–´ì•¼ í•˜ë©°, ë§Œì•½ ì¢…ë£Œ ì˜¤í¼ë ˆì´ì…˜ì´ ì—†ë‹¤ë©´, ìŠ¤íŠ¸ë¦¼ì€ ì¡´ì¬í•˜ì§€ë§Œ ì½”ë“œ ìˆ˜í–‰ì€ ë˜ì§€ ì•ŠëŠ”ë‹¤.

ìŠ¤íŠ¸ë¦¼ì˜ ë°ì´í„° ì†ŒìŠ¤ëŠ” ì˜¤ì§ í„°ë¯¸ë„ ì˜¤í¼ë ˆì´ì…˜ì„ ì‹¤í–‰í•  ë•Œì—ë§Œ ì²˜ë¦¬í•œë‹¤!

### 2-1. ì¤‘ê°œ ì˜¤í¼ë ˆì´ì…˜

> Streamì„ ë¦¬í„´í•œë‹¤!

- Stateless/Stateful ì˜¤í¼ë ˆì´ì…˜ìœ¼ë¡œ ë” ìƒì„¸í•˜ê²Œ êµ¬ë¶„í•  ìˆ˜ë„ ìˆë‹¤. 
- ëŒ€ë¶€ë¶„ Statelessì§€ë§Œ distinctë‚˜ sortedì²˜ëŸ¼ ì´ì „ ì†ŒìŠ¤ ë°ì´í„°ë¥¼ ì°¸ì¡°í•´ì•¼ í•˜ëŠ” ì˜¤í¼ë ˆì´ì…˜ì€ Stateful ì˜¤í¼ë ˆì´ì…˜.
- `filter, map, limit, skip, sorted, ...`

### 2-2. ì¢…ë£Œ ì˜¤í¼ë ˆì´ì…˜
> Streamì„ ë¦¬í„´í•˜ì§€ ì•ŠëŠ”ë‹¤!

- `collect, allmatch, count, forEach, min, max...`

```java
public static void main(String[] args) {
        List<String> names = new ArrayList<>();
        names.add("hansol");
        names.add("toby");
        names.add("catsbi");
        names.add("mijeong");

        List<String> collect = names.stream().map(s -> {
            System.out.println(s);
            return s.toUpperCase();
        }).collect(Collectors.toList());
        collect.forEach(System.out::println);
    }
```     

## 3. Stream API

> stream apië¥¼ ì˜ˆì œë¥¼ í†µí•´ ì•Œì•„ë³´ì.

1. ê±¸ëŸ¬ë‚´ê¸° 
   - Filter(Predicate)
   - streamì—ì„œ íŠ¹ì • ì¡°ê±´(Predicate)ì„ ë§Œì¡±í•˜ëŠ” ì—˜ë¦¬ë¨¼íŠ¸ë§Œ ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë°˜í™˜
2. ë³€ê²½í•˜ê¸°
   - Map(Function) ë˜ëŠ” FlatMap(Function)
   - ê°ê°ì˜ ìš”ì†Œì—ì„œ íŠ¹ì •ìš”ì†Œë§Œ êº¼ë‚´ê±°ë‚˜ í˜¹ì€ ë³€ê²½í•˜ì—¬ ìƒˆë¡œìš´ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë°˜í™˜
   - flatMapì˜ ê²½ìš° Arrayë‚˜ Objectë¡œ ë˜í•‘ë˜ì–´ìˆëŠ” ë‚´ìš©ë¬¼ì„ êº¼ë‚´ì–´ í•˜ë‚˜ë¡œ í•©ì¹œ  ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ìƒì„± í›„ ë°˜í™˜
3. ìƒì„±í•˜ê¸°
   - generate(Supplier) ë˜ëŠ” Iterator(T seed, UnaryOperator)
   - seed ë¡œë¶€í„° UnaryOperator ì„ ë¬´ì œí•œìœ¼ë¡œ ë°˜ë³µí•˜ëŠ” ìŠ¤íŠ¸ë¦¼ ë°˜í™˜
   - ex: ëœë¤ ë¬´ì œí•œ ìŠ¤íŠ¸ë¦¼
4. ìŠ¤íŠ¸ë¦¼ì— ìˆëŠ” ë°ì´í„°ê°€ íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸
   - anyMatch(), allMatch(), nonMatch()
   - ìŠ¤íŠ¸ë¦¼ì˜ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ëŒë©° íŠ¹ì • ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ”ì§€ í™•ì¸
   - ex1:  ìŠ¤íŠ¸ë¦¼ì˜ ìˆëŠ” ëª¨ë“  ê°’ì´ 10ë³´ë‹¤ ì‘ì€ì§€ í™•ì¸(allMatch)
   - ex2: ìŠ¤íŠ¸ë¦¼ì˜ ì œëª© ì¤‘ "Test"ê°€ ë“¤ì–´ê°€ëŠ” ì œëª©ì´ ìˆëŠ”ì§€ í™•ì¸(anyMatch)
5. ê°œìˆ˜ ì„¸ê¸°
   - count()
   - ex1: 10ë³´ë‹¤ ì‘ì€ ìˆ˜ì˜ ê°¯ìˆ˜ë¥¼ ì„¼ë‹¤.
6. ìŠ¤íŠ¸ë¦¼ì„ ë°ì´í„° í•˜ë‚˜ë¡œ ë­‰ì¹˜ê¸°
   - reduce(identity, ByFunction), collect(), sum(), max()
   - ex1: ëª¨ë“  ìˆ«ì í•© êµ¬í•˜ê¸°
   - ex2: ëª¨ë“  ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ í˜¹ì€ Setì— ì˜®ê²¨ ë‹´ê¸°

```java
public static void main(String[] args) {
    List<OnlineClass> springClasses = new ArrayList<>();
    springClasses.add(new OnlineClass(1, "spring boot", true));
    springClasses.add(new OnlineClass(2, "spring data jpa", true));
    springClasses.add(new OnlineClass(3, "spring mvc", false));
    springClasses.add(new OnlineClass(4, "spring core", false));
    springClasses.add(new OnlineClass(5, "rest api development", false));

    List<OnlineClass> javaClasses = new ArrayList<>();
    javaClasses.add(new OnlineClass(6, "The Java, Test", true));
    javaClasses.add(new OnlineClass(7, "The Java, Code mainpulation", true));
    javaClasses.add(new OnlineClass(8, "The Java 8 to 11", false));

    List<List<OnlineClass>> keesunEvents = new ArrayList<>();
    keesunEvents.add(springClasses);
    keesunEvents.add(javaClasses);


    System.out.println("springìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ìˆ˜ì—…");
    springClasses.stream()
            .filter(oc -> oc.getTitle().startsWith("spring"))
            .forEach(System.out::println);

    System.out.println("closedë˜ì§€ ì•Šì€ ìˆ˜ì—…");
    springClasses.stream()
            .filter(Predicate.not(OnlineClass::isClosed))
            .forEach(System.out::println);

    System.out.println("ìˆ˜ì—… ì´ë¦„ë§Œ ëª¨ì•„ì„œ ìŠ¤íŠ¸ë¦¼ ë§Œë“¤ê¸°");
    Stream<String> springTitleStream = springClasses.stream()
            .map(OnlineClass::getTitle);
    springTitleStream.forEach(System.out::println);

    System.out.println("ë‘ ìˆ˜ì—… ëª©ë¡ì— ë“¤ì–´ìˆëŠ” ëª¨ë“  ìˆ˜ì—… ì•„ì´ë”” ì¶œë ¥");
    keesunEvents.stream()
            .flatMap(Collection::stream)
            .forEach(oc-> System.out.println(oc.getId()));

    System.out.println("10ë¶€í„° 1ì”© ì¦ê°€í•˜ëŠ” ë¬´ì œí•œ ìŠ¤íŠ¸ë¦¼ ì¤‘ì—ì„œ ì•ì— 10ê°œ ë¹¼ê³  ìµœëŒ€ 10ê°œ ê¹Œì§€ë§Œ");
    Stream.iterate(10, i -> i+1)
            .skip(10)
            .limit(10)
            .forEach(System.out::println);

    System.out.println("ìë°” ìˆ˜ì—… ì¤‘ì— Testê°€ ë“¤ì–´ìˆëŠ” ìˆ˜ì—…ì´ ìˆëŠ”ì§€ í™•ì¸");
    boolean test = javaClasses.stream().
            anyMatch(oc -> oc.getTitle().contains("Test"));
    System.out.println(test);

    System.out.println("ìŠ¤í”„ë§ ìˆ˜ì—… ì¤‘ì— ì œëª©ì´ springì´ ë“¤ì–´ê°„ ì œëª©ë§Œ ëª¨ì•„ì„œ Listë¡œ ë§Œë“¤ê¸°");
    List<String> spring = springClasses.stream()
            .filter(oc -> oc.getTitle().contains("spring"))
            .map(OnlineClass::getTitle)
            .collect(Collectors.toList());
    spring.forEach(System.out::println);
}
```

## Reference

- [ë°±ê¸°ì„  ì¸í”„ëŸ° ê°•ì˜ : ë” ìë°”, Java8](https://www.inflearn.com/course/the-java-java8/dashboard)
- [Catsbi's DLog : Stream](https://catsbi.oopy.io/5a5d3981-7f25-443b-bc8c-15d270935cd7)