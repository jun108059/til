## 1. ì‹±ê¸€í†¤ íŒ¨í„´ì´ë€?

> **ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì˜¤ì§ í•œ ê°œë§Œ ë§Œë“¤ì–´ì„œ ì œê³µí•˜ëŠ” í´ë˜ìŠ¤**ê°€ í•„ìš”í•œ ê²½ìš°ì— ì‚¬ìš©í•˜ëŠ” íŒ¨í„´

![img](https://user-images.githubusercontent.com/42997924/143546595-d548b627-e85d-4fed-be93-19ff66eafaa6.png)

ì¦‰, í´ë˜ìŠ¤ê°€ ìµœì´ˆ í•œë²ˆë§Œ ë©”ë¡œë¦¬ë¥¼ í• ë‹¹ë°›ê³  ê·¸ ë©”ëª¨ë¦¬ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ëŠ” ë””ìì¸ íŒ¨í„´ìœ¼ë¡œ ìƒì„±ìê°€ ì—¬ëŸ¬ ì°¨ë¡€ í˜¸ì¶œë˜ë”ë¼ë„ ì‹¤ì œ ìƒì„±ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ëŠ” ê¸°ì¡´ì— ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ì´ë‹¤.

### 1-1. ì •ì˜(Definition)

ì†Œí”„íŠ¸ì›¨ì–´ ë””ìì¸ íŒ¨í„´ì—ì„œ ì‹±ê¸€í„´ íŒ¨í„´(Singleton pattern)ì„ ë”°ë¥´ëŠ” í´ë˜ìŠ¤ëŠ”, ìƒì„±ìê°€ ì—¬ëŸ¬ ì°¨ë¡€ í˜¸ì¶œë˜ë”ë¼ë„ ì‹¤ì œë¡œ ìƒì„±ë˜ëŠ” ê°ì²´ëŠ” í•˜ë‚˜ì´ê³  ìµœì´ˆ ìƒì„± ì´í›„ì— í˜¸ì¶œëœ ìƒì„±ìëŠ” ìµœì´ˆì˜ ìƒì„±ìê°€ ìƒì„±í•œ ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤. ì´ì™€ ê°™ì€ ë””ìì¸ ìœ í˜•ì„ ì‹±ê¸€í„´ íŒ¨í„´ì´ë¼ê³  í•œë‹¤. ì£¼ë¡œ ê³µí†µëœ ê°ì²´ë¥¼ ì—¬ëŸ¬ ê°œ ìƒì„±í•´ì„œ ì‚¬ìš©í•˜ëŠ” **DBCP(DataBase Connection Pool)** ì™€ ê°™ì€ ìƒí™©ì—ì„œ ë§ì´ ì‚¬ìš©ëœë‹¤ê³  í•œë‹¤.

### 1-2. ì‚¬ìš© ì´ìœ 

ì‹œìŠ¤í…œ ëŸ°íƒ€ì„, í™˜ê²½ ì„¸íŒ… ê´€ë ¨ ì •ë³´ ë“± ì¸ìŠ¤í„´ìŠ¤ê°€ ì—¬ëŸ¬ ê°œì¼ ë•Œ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš° ë“±ì´ ìˆëŠ”ë° ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ê°€ì ¸ê°ˆ ìˆ˜ ìˆëŠ” ì´ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1.  **ë©”ëª¨ë¦¬, ì†ë„ ì¸¡ë©´** : ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•˜ê¸° ë•Œë¬¸(ê³ ì •ëœ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ì‚¬ìš©)
2.  **ë°ì´í„° ê³µìœ ê°€ ì‰¬ì›€** : ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ê°€ ì „ì—­ìœ¼ë¡œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸
3.  ì¸ìŠ¤í„´ìŠ¤ê°€ **í•œ ê°œë§Œ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ë³´ì¥**í•˜ê³  ì‹¶ì€ ê²½ìš°

### 1-3. ì‹±ê¸€í†¤ íŒ¨í„´ êµ¬í˜„

-   **private constructor** ì„ ì–¸
-   **static method** ì‚¬ìš©

ì‹±ê¸€í†¤ íŒ¨í„´ì—ì„œëŠ” ìƒì„±ìë¥¼ í´ë˜ìŠ¤ ìì²´ì—ì„œë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— privateìœ¼ë¡œ ì ‘ê·¼ ì œì–´ë¥¼ í•´ì•¼ í•œë‹¤.

> âœğŸ» **ì£¼ì˜í•  ì **  
> ì¸ìŠ¤í„´ìŠ¤ëŠ” ìƒì„± ì´í›„ ìˆ˜ì •ì´ ë˜ì§€ ì•Šë„ë¡ ë§‰ì•„ì£¼ì.  
> ìƒì„± ì´í›„ì— í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ NULLë¡œ ì´ˆê¸°í™”í•´ë²„ë¦´ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ë§Œ ì¡´ì¬í•¨ì„ ë³´ì¥í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— Single Threadì—ì„œëŠ” ë¬¸ì œê°€ ë˜ì§€ ì•Šì§€ë§Œ Multi Thread í™˜ê²½ì—ì„œ ì‹±ê¸€í†¤ ê°ì²´ì— ì ‘ê·¼ ì‹œ ì´ˆê¸°í™” ê´€ë ¨í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

ì•„ë˜ì—ì„œ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ì„ ì•Œì•„ë³´ì.

#### 1-3-1. ì´ë¥¸ ì´ˆê¸°í™”(Eager Initialization)

static í‚¤ì›Œë“œë¥¼ í†µí•´ í´ë˜ìŠ¤ ë¡œë”ê°€ ì´ˆê¸°í™”í•˜ëŠ” ì‹œì ì— **ì •ì  ë°”ì¸ë”©(Static Binding)**ì„ í†µí•´ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë©”ëª¨ë¦¬ì— ë“±ë¡í•˜ê¸° ë•Œë¬¸ì— **Thread-safe** í•˜ë‹¤.

```java
public class Singleton {
    private static final Singleton INSTANCE = new Singleton();
    
    private Singleton() {}
    
    public static Singleton getInstance() {
        return INSTANCE;
    }
}
```

> ì¥ì   
> **Thread-safe**
>
> ë‹¨ì   
> ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ê¸° ë•Œë¬¸ì— ì‹¤ì œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œ ì†í•´

#### 1-3-2. ëŠ¦ì€ ì´ˆê¸°í™”(Lazy Initialization)

ì¸ìŠ¤í„´ìŠ¤ë¥¼ **ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ì„œ ìƒì„±**í•˜ëŠ” ë°©ë²• - **ë™ì  ë°”ì¸ë”©(Dynamic Binding)**

-   ì´ë¥¸ ì´ˆê¸°í™” ë°©ë²•ë³´ë‹¤ ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œ íš¨ìœ¨ì 
-   ì•„ë˜ **getInstance( )** ëŠ” ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œëŠ” ì•ˆì „í•˜ì§€ ì•Šë‹¤.

```java
public class Singleton {
    private static Singleton instance;
    private Singleton() { }

    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
```

ë§Œì•½ ë‘ Thread ê°€ ë™ì‹œì— í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ê·¼ ì‹œí•˜ë©´ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ë³´ê³  ì¤‘ë³µìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

```bash
Thread A : if(INSTANCE == null) ìˆ˜í–‰ ê²°ê³¼ true
Thread B : if(INSTANCE == null) ìˆ˜í–‰ ê²°ê³¼ true

Thread A : INSTANCE = new Singleton() ìˆ˜í–‰ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤1 ìƒì„±
Thread B : INSTANCE = new Singleton() ìˆ˜í–‰ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤2 ìƒì„±
```

> ì¥ì   
> **ì‚¬ìš© ì‹œì ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©**
>
> ë‹¨ì   
> Thread Safe í•˜ì§€ ì•ŠìŒ

#### 1-3-3. ëŠ¦ì€ ì´ˆê¸°í™”, ë™ê¸°í™” ì²˜ë¦¬(Lazy Initialization with synchronized)

ìœ„ì—ì„œ ì‚´í´ë³¸ Lazy Initializationì˜ ë©€í‹° ìŠ¤ë ˆë“œ ë¬¸ì œëŠ” **Synchronized** í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í†µí•´ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

ë‹¨ì ì€ getInstance( )ë¥¼ í˜¸ì¶œ ì‹œì— í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„± ì—¬ë¶€ì™€ ìƒê´€ ì—†ì´ **ë™ê¸°í™”** ë¸”ë¡ì„ ê±°ì³ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ ë™ê¸°í™”ë¼ëŠ” ê³¼ì •ì´ ë½(Lock)ì„ ê±°ëŠ” ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì´ ë–¨ì–´ì§ˆ ìˆ˜ ë°–ì— ì—†ë‹¤.

```java
public class Singleton {
    private static Singleton instance;
    private Singleton() { }

    public static synchronized Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
```

> ì¥ì   
> **ë©”ëª¨ë¦¬ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©, Thread Safe**
>
> ë‹¨ì   
> ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì—¬ë¶€ì™€ ìƒê´€ì—†ëŠ” ë™ê¸°í™”(Lock) ë•Œë¬¸ì— ì„±ëŠ¥ì´ ë–¨ì–´ì§

#### 1-3-4. ëŠ¦ì€ ì´ˆê¸°í™”, DCL(Lazy Initialization. Double Checked Locking)

ìœ„ ë™ê¸°í™” ë¸”ëŸ­ ë°©ì‹ì„ ê°œì„ í•œ ë°©ì‹ìœ¼ë¡œ, **ë¨¼ì € ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„± ì—¬ë¶€ë¥¼ í™•ì¸**í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.

ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì§€ ì•Šì€ ê²½ìš°ì— ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í•˜ê¸° ë•Œë¬¸ì— **íš¨ìœ¨ì ìœ¼ë¡œ ë™ê¸°í™”** ë¸”ë¡ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```java
public class Singleton {
    private volatile static Singleton instance;
    private Singleton() { }

    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                if(instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

ì´ ê²½ìš°ì—ëŠ” **volatile** í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì•¼ DCLì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•  ìˆ˜ ìˆë‹¤.

ë©€í‹°ìŠ¤ë ˆë”©ì„ ì“°ë”ë¼ë„ instance ë³€ìˆ˜ê°€ Sigleton ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ˆê¸°í™” ë˜ëŠ” ê³¼ì •ì´ ì˜¬ë°”ë¥´ê²Œ ì§„í–‰ë˜ê¸° ë•Œë¬¸ì´ë‹¤.

> 
> volatile í‚¤ì›Œë“œê°€ í•„ìš”í•œ ì´ìœ  ?
>
> volatile ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ ì•ŠëŠ” ë©€í‹° ìŠ¤ë ˆë“œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ì‘ì—…(Task)ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ **ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ Main Memory ì—ì„œ ì½ì€ ë³€ìˆ˜ ê°’ì„ CPU Cache ì— ì €ì¥**í•˜ê²Œ ëœë‹¤. ë§Œì•½ì— ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ìŠ¤ë ˆë“œê°€ ë³€ìˆ˜ ê°’ì„ ì½ì–´ì˜¬ ë•Œ ê°ê°ì˜ CPU Cache ì— ì €ì¥ëœ ê°’ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— **ë³€ìˆ˜ ê°’ ë¶ˆì¼ì¹˜ ë¬¸ì œê°€ ë°œìƒ**í•˜ê²Œ ë˜ëŠ”ë°, volatile í‚¤ì›Œë“œê°€ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
>
> ì¦‰, volatile ë³€ìˆ˜ëŠ” **Main Memory ì— ê°’ì„ ì €ì¥í•˜ê³  ì½ì–´ì˜¤ê¸° ë•Œë¬¸ì—(read and write)** ë³€ìˆ˜ ê°’ ë¶ˆì¼ì¹˜ ë¬¸ì œê°€ ìƒê¸°ì§€ ì•ŠëŠ”ë‹¤.
>
> 1. í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œëŠ” read and write í•˜ë©°, ë‚˜ë¨¸ì§€ ìŠ¤ë ˆë“œëŠ” read ë§Œ í•˜ëŠ” ê²½ìš° ë³€ìˆ˜ì˜ ìµœì‹  ê°’ì„ ë³´ì¥í•œë‹¤.  
> 2. ì—¬ëŸ¬ê°œì˜ ìŠ¤ë ˆë“œê°€ write í•˜ëŠ” ìƒí™©ì´ë¼ë©´ ë™ê¸°í™” ë¸”ëŸ­(synchronized) ì„ ì§€ì •í•´ì„œ ì›ìì„±(atomic) ì„ ë³´ì¥í•´ì•¼ í•œë‹¤.
>
> ì¶œì²˜ : [webdevtechblog : ì‹±ê¸€í„´ íŒ¨í„´](https://webdevtechblog.com/%EC%8B%B1%EA%B8%80%ED%84%B4-%ED%8C%A8%ED%84%B4-singleton-pattern-db75ed29c36)

jdk 1.5 ë²„ì „ ì´í•˜ì¼ë•Œ volatileì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œ ë°œìƒí•œ DCL ì½”ë“œë¥¼ ë³´ë©´ ë” ì´í•´ê°€ ì‰½ë‹¤. [ë‹¤ë¥¸ ë¸”ë¡œê·¸](https://javaplant.tistory.com/21) ì—ì„œ ì •ë¦¬ë¥¼ ì˜ í•´ë‘ì—ˆë‹¤. ê¶ê¸ˆí•˜ë©´ ì½ì–´ë³´ì!

> ì¥ì   
> - ë©”ëª¨ë¦¬ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©  
> - Thread Safe  
> - ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì—¬ë¶€ ê²€ì‚¬ (Lock ì´ìŠˆ í•´ê²°)  
>  
> ë‹¨ì   
> - ë¹„ë™ê¸°í™”ëœ Resource í•„ë“œì— ì˜ì¡´í•˜ê²Œ ë˜ì–´ ìœ„ì—ì„œ ì•Œì•„ë³¸ ê²ƒ ì²˜ëŸ¼ ë³€ìˆ˜ì˜ ìµœì‹  ê°’ì´ë‚˜ ì›ìì„±ì„ ë³´ì¥í•´ì¤˜ì•¼í•œë‹¤.  
> - ìì„¸íˆ ì•Œì•„ë³´ë ¤ë©´ [í•´ë‹¹ ê¸€](https://www.infoworld.com/article/2074979/double-checked-locking--clever--but-broken.html) ì„ ì½ì–´ë³´ì. [ë²ˆì—­í•œ ê¸€](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=sthwin&logNo=220836837262) ë„ ìˆë‹¤.

#### 1-3-5. LazyHolder - ëŠ¦ì€ ì´ˆê¸°í™”, Static Inner classì‚¬ìš©

í´ë˜ìŠ¤ ì•ˆì— **í´ë˜ìŠ¤(Holder)** ë¥¼ ë‘ì–´ JVMì˜ Class loader ë©”ì»¤ë‹ˆì¦˜ê³¼ Classê°€ Load ë˜ëŠ” ì‹œì ì„ ì´ìš©í•œ ë°©ë²•ì´ë‹¤.

```java
public class Singleton {
    private Singleton() { }

    private static class SingletonHolder {
        public static final Singleton INSTANCE = new Singleton();
    }
    
    public static Singlton getInstance() {
        return SingletonHolder.INSTANCE;
    }
}
```

ì—¬ê¸°ì„œ getInstanceê°€ í˜¸ì¶œë  ë•Œ **SingletonHolder í´ë˜ìŠ¤**ê°€ í˜¸ì¶œì´ ë˜ë©´ ì‹¤ì œ ì¸ìŠ¤í„´ìŠ¤ê°€ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ ì´ìŠˆê°€ ì—†ë‹¤.

Singleton í´ë˜ìŠ¤ì˜ getInstance() ë©”ì„œë“œì—ì„œ SingletonHolder.INSTANCEë¥¼ ì°¸ì¡°í•˜ëŠ” ìˆœê°„ Classê°€ ë¡œë”©ë˜ë©° ì´ˆê¸°í™”ê°€ ì§„í–‰ëœë‹¤. Classë¥¼ ë¡œë”©í•˜ê³  ì´ˆê¸°í™”í•˜ëŠ” ì‹œì ì€ **thread-safe**ë¥¼ ë³´ì¥í•˜ê¸° ë•Œë¬¸ì— **volatileì´ë‚˜ synchronized ê°™ì€ í‚¤ì›Œë“œê°€ ì—†ì–´ë„ ëœë‹¤.**

ë‹¤ë§Œ, ì´ê²½ìš°ì—ë„ í•´ë‹¹ ì‹±ê¸€í†¤ íŒ¨í„´ì„ ê¹¨íŠ¸ë¦´ ìˆ˜ ìˆëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì€ ìˆë‹¤.

1.  ë¦¬í”Œë ‰ì…˜ì˜ ì‚¬ìš©
2.  ì§ë ¬í™” ê·¸ë¦¬ê³  ì—­ì§ë ¬í™”ì˜ ì‚¬ìš©

**ë¦¬í”Œë ‰ì…˜ì˜ ì‚¬ìš©**ì„ ë¨¼ì € ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```java
public class Application {
    public static void main(String[] args) throws NoSuchMethodExceotion, 
                                                  InvocationTargetException,
                                                  InstantiationExcetpion {
        Singleton singleton = Singleton.getInstance();
    
        Constructor<Singleton> constructor = Singleton.class.getDeclaredConstructor();
        constructor.setAccessible(true);
        Singleton singleton2 = constructor.newInstance();
    
        System.out.println(singleton == singletons2);    //false
    }
}
```

ì˜ë„í•œ ë°”ì™€ ë‹¤ë¥´ê²Œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê²Œ ë˜ë©´ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë  ìˆ˜ë‹¤.

ë˜ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œëŠ” **ì§ë ¬í™”ì™€ ì—­ì§ë ¬í™”ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•**ì´ ìˆë‹¤.

```java
public class Application {
    public static void main(String[] args) throws IOException {
        Singleton singleton = Singleton.getInstance();
        Singleton singleton2 = null;
        
        try (ObjectOutput out = new ObjectOutputStream(new FileOutputStream("singleton.obj"))) {
            out.writeObject(singleton);
        }
        
        try (ObjectInput in = new ObjectInputStream(new FileInputStream("singleton.obj"))) {
            singleton2 = (singleton) in.readObject();
        }
        
        System.out.println(singleton == singleton2);    //false
    }
}
```

ì—­ì§ë ¬í™”ë¥¼ í•˜ëŠ” ê³¼ì •ì—ì„œ ìƒˆë¡œ ìƒì„±ìê°€ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤.

ë‹¤ë§Œ ì—­ì§ë ¬í™”ì˜ ê²½ìš°ì—ëŠ” readResolveë¥¼ ìƒì„±í•´ì£¼ë©´ í•´ë‹¹ ì¼€ì´ìŠ¤ì— ëŒ€í•˜ì—¬ ëŒ€ì‘í•  ìˆ˜ ìˆë‹¤.

```java
public class Singleton implements Serializable {
    private Singleton() { }

    private static class SingletonHolder {
        public static final Singleton INSTANCE = new Singleton();
    }
    
    public static Singlton getInstance() {
        return SingletonHolder.INSTANCE;
    }
    
    protected Object readResolve() {
        return getInstance();
    }
}
```

í•˜ì§€ë§Œ ë¦¬í”Œë ‰ì…˜ì˜ ê²½ìš° ë”±íˆ ëŒ€ì‘ì´ í˜ë“¤ê¸° ë•Œë¬¸ì— ìƒˆë¡œìš´ ì‹±ê¸€í†¤ íŒ¨í„´ì˜ êµ¬í˜„ ë°©ë²•ì´ í•„ìš”í•˜ë‹¤.

#### ëŠ¦ì€ ì´ˆê¸°í™”, Enum ì‚¬ìš©

Enum ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„±ì€ ê¸°ë³¸ì ìœ¼ë¡œ Thread-safe í•˜ê¸° ë•Œë¬¸ì— ìŠ¤ë ˆë“œ ê´€ë ¨ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë˜ê¸° ë•Œë¬¸ì— ê°„í¸í•´ì§„ë‹¤.

```java
public enum Singleton {
    INSTANCE;
}
```

Enumì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì˜ ì¥ì ì€ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ë¦¬í”Œë™ì…˜, ì§ë ¬í™”ì™€ ì—­ì§ë ¬í™”ì˜ ìƒí™©ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.

ë‹¤ë§Œ,  ì´ ê²½ìš°ì—ëŠ” ìƒì†ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ë˜í•œ, Contextì˜ì¡´ì„±ì´ ìˆëŠ” í™˜ê²½ì—ì„œëŠ” ì‹±ê¸€í„´ì˜ ì´ˆê¸°í™” ê³¼ì •ì— Contextë¼ëŠ” ì˜ì¡´ì„±ì´ ë¼ì–´ë“¤ ê°€ëŠ¥ì„±ì´ ìˆëŠ” ë‹¨ì ì´ ìˆë‹¤.

### ì‹±ê¸€í†¤ì€ ì–´ë–»ê²Œ ì‚¬ìš©ë ê¹Œ?

ê·¸ë ‡ë‹¤ë©´ ì‹¤ë¬´ì—ì„œì˜ ì‹±ê¸€í†¤ íŒ¨í„´ì€ ì–´ë–»ê²Œ ì‚¬ìš©ë ê¹Œ?

ìš°ì„  ë‹¤ë¥¸ ë””ìì¸ íŒ¨í„´ êµ¬í˜„ì²´ì˜ ì¼ë¶€ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë©°, ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì‚¬ìš©ëœë‹¤.

#### java.lang.Runtime

Runtimeì´ë¼ëŠ” ìë°”ê°€ ì œê³µí•˜ê³  ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

```java
Runtime runtime = Runtime.getRuntime();
```

new ìƒì„±ìë¥¼ í†µí•´ ìƒì„±í•  ìˆ˜ ì—†ë‹¤.

#### ìŠ¤í”„ë§ì—ì„œì˜ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„

íŠ¹ì • ì •ì˜ëœ ë¹ˆì„ ê°€ì§€ê³  ApplicationContextë¥¼ ë§Œë“¤ë©´ í•­ìƒ ê°™ì€ typeì˜ ë¹ˆì´ ë‚˜ì˜¤ê²Œ ëœë‹¤.

```
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(Singleton.class);
```

ì´ê²½ìš° ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ë¼ê³  ë§í•˜ëŠ”ë° ì—„ë°€íˆ ë§í•´ì„œëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ê³¼ëŠ” ë‹¤ë¥´ë‹¤ê³  í•œë‹¤.

ApplicationContextë‚´ë¶€ì—ì„œ ìœ ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¡œì„œ ê´€ë¦¬ê°€ ë˜ëŠ” ê²ƒì¼ ë¿ì´ê¸° ë•Œë¬¸ì´ë‹¤.

**Reference**

-   [ì¸í”„ëŸ° - ì½”ë”©ìœ¼ë¡œ í•™ìŠµí•˜ëŠ” GoFì˜ ë””ìì¸ íŒ¨í„´](https://www.inflearn.com/course/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4/dashboard)
-   [webdevtechblog : ì‹±ê¸€í„´ íŒ¨í„´](https://webdevtechblog.com/%EC%8B%B1%EA%B8%80%ED%84%B4-%ED%8C%A8%ED%84%B4-singleton-pattern-db75ed29c36)
-   [https://javaplant.tistory.com/21](https://javaplant.tistory.com/21)
-   [https://www.infoworld.com/article/2074979/double-checked-locking--clever--but-broken.html](https://www.infoworld.com/article/2074979/double-checked-locking--clever--but-broken.html)