# ElasticSearch ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤ìŠµ

![img](../.vuepress/public/images/img-es/1.elasticsearchLogo.png)  

---

### ì‹¤ìŠµ í™˜ê²½
### ğŸ’¡ Elasticsearch 7.9.0
### ğŸ’¡ Windows 10
### ğŸ’¡ Git Bash

---

## 1. (Create) Document ìƒì„±í•˜ê¸°

ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´ Documentê°€ ë¨¼ì € ìƒì„±ë˜ì–´ ìˆì–´ì•¼í•œë‹¤.

ìƒì„±í•˜ëŠ” ëª…ë ¹ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```bash
$ curl -XPOST http://localhost:9200/classes/class/1/?pretty -H 'Content-Type: application/json' -d '{"title" : "Algorithm", "professor" : "yj_park"}'
```

í™•ì¸í•˜ê¸°

```bash
$ curl -XGET http://localhost:9200/classes/class/1/?pretty
```

ê²°ê³¼

```bash
{
  "_index" : "classes",
  "_type" : "class",
  "_id" : "1",
  "_version" : 3,
  "_seq_no" : 2,
  "_primary_term" : 1,
  "found" : true,
  "_source" : {
    "title" : "Algorithm",
    "professor" : "yj_park"
  }

}
```

---

## 2. (Update) Documentì— Field ì¶”ê°€í•˜ê¸°

ê³¼ëª©ì€ `Algorithm`ì´ê³  êµìˆ˜ëŠ” `yj_park`ì¸ë°

ëª‡ í•™ì ì§œë¦¬ ê°•ì˜ì¸ì§€ `Field`ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤.

`_update`ê°€ í¬í•¨ëœ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```bash
$ curl -XPOST http://localhost:9200/classes/class/1/_update?pretty -H 'Content-Type: application/json' -d '{"doc" : {"unit" : 1}}'
```

ê²°ê³¼

```bash
{
  "_index" : "classes",
  "_type" : "class",
  "_id" : "1",
  "_version" : 4,
  "result" : "updated",
  "_shards" : {
    "total" : 2,
    "successful" : 1,
    "failed" : 0
  },
  "_seq_no" : 3,
  "_primary_term" : 1
}
```

í™•ì¸í•´ë³´ê¸° ìœ„í•´ GET REST APIë¥¼ ì‘ì„±í•´ë³´ì.

```bash
curl -XGET http://localhost:9200/classes/class/1/?pretty
```

ê²°ê³¼

```bash
{
  "_index" : "classes",
  "_type" : "class",
  "_id" : "1",
  "_version" : 4,
  "_seq_no" : 3,
  "_primary_term" : 1,
  "found" : true,
  "_source" : {
    "title" : "Algorithm",
    "professor" : "yj_park",
    "unit" : 1
  }
}
```

---

## 3. (Update) ê¸°ì¡´ Field ê°’ ë³€ê²½í•˜ê¸°

í•™ì  Fieldì¸ `unit`ì„ 1í•™ì ì—ì„œ 2í•™ì ìœ¼ë¡œ ë³€ê²½í•´ë³´ì.

ìƒˆë¡œìš´ fieldë¥¼ ì¶”ê°€í•  ë•Œì™€ ê°™ì€ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ê³  unitì˜ ë³€ê²½í•  ê°’ë§Œ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```bash
$ curl -XPOST http://localhost:9200/classes/class/1/_update?pretty -H 'Content-Type: application/json' -d '{"doc" : {"unit" : 2}}'
```

ë³€ê²½ëëŠ”ì§€ í™•ì¸í•´ë³´ì.

```bash
$ curl -XGET http://localhost:9200/classes/class/1/?pretty
```

ê²°ê³¼

```bash
{
  "_index" : "classes",
  "_type" : "class",
  "_id" : "1",
  "_version" : 5,
  "_seq_no" : 4,
  "_primary_term" : 1,
  "found" : true,
  "_source" : {
    "title" : "Algorithm",
    "professor" : "yj_park",
    "unit" : 2
  }
}

```

## 4. (Update) Scriptë¥¼ í™œìš©í•œ Field ê°’ ë³€ê²½í•˜ê¸°

ì‹¤ì œ ì½”ë”©í•  ë•Œ ìœ ìš©í•˜ê²Œ ì“°ë ¤ë©´ `Script`ë¥¼ í™œìš©í•˜ë©´ ì¢‹ë‹¤.

```bash
$ curl -XPOST http://localhost:9200/classes/class/1/_update?pretty -H 'Content-Type: application/json' -d '{"script" : "ctx._source.unit += 5"}'
```

í•™ì `unit`ì´ `5í•™ì ` ë” ì˜¬ë¼ê°”ëŠ”ì§€ í™•ì¸í•´ë³´ì

```bash
$ curl -XGET http://localhost:9200/classes/class/1/?pretty
```

ê²°ê³¼

```bash
{
  "_index" : "classes",
  "_type" : "class",
  "_id" : "1",
  "_version" : 6,
  "_seq_no" : 5,
  "_primary_term" : 1,
  "found" : true,
  "_source" : {
    "title" : "Algorithm",
    "professor" : "yj_park",
    "unit" : 7
  }
}
```

---

> ë³¸ í¬ìŠ¤íŒ…ì€ `Inflearn`ì˜ [ELK ìŠ¤íƒ (ElasticSearch, Logstash, Kibana) ìœ¼ë¡œ ë°ì´í„° ë¶„ì„](https://www.inflearn.com/course/elk-%EC%8A%A4%ED%83%9D-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D) ê°•ì˜ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---
