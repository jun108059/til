<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>도커 설치하기 | Today Youngjun learned✍</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="/til/images/logo-144.png">
    <link rel="manifest" href="/til/manifest.json">
    <meta name="description" content="Youngjun`s Personal Wiki (Today I Learned)">
    <link rel="preload" href="/til/assets/css/0.styles.bf2a48be.css" as="style"><link rel="preload" href="/til/assets/js/app.00b9b90c.js" as="script"><link rel="preload" href="/til/assets/js/2.2e6f6d7d.js" as="script"><link rel="preload" href="/til/assets/js/37.9007b1f9.js" as="script"><link rel="preload" href="/til/assets/js/4.5194b884.js" as="script"><link rel="prefetch" href="/til/assets/js/10.5e347995.js"><link rel="prefetch" href="/til/assets/js/11.7375bce5.js"><link rel="prefetch" href="/til/assets/js/12.2be30b17.js"><link rel="prefetch" href="/til/assets/js/13.3e1c3aeb.js"><link rel="prefetch" href="/til/assets/js/14.c839ebd8.js"><link rel="prefetch" href="/til/assets/js/15.36909eb0.js"><link rel="prefetch" href="/til/assets/js/16.30520ced.js"><link rel="prefetch" href="/til/assets/js/17.d2fd0e34.js"><link rel="prefetch" href="/til/assets/js/18.4366af02.js"><link rel="prefetch" href="/til/assets/js/19.1eddef5f.js"><link rel="prefetch" href="/til/assets/js/20.603a6fdc.js"><link rel="prefetch" href="/til/assets/js/21.6f598d1d.js"><link rel="prefetch" href="/til/assets/js/22.0dfb3183.js"><link rel="prefetch" href="/til/assets/js/23.43d1c3c5.js"><link rel="prefetch" href="/til/assets/js/24.a8e5e42e.js"><link rel="prefetch" href="/til/assets/js/25.1a9cc97f.js"><link rel="prefetch" href="/til/assets/js/26.042fbd0a.js"><link rel="prefetch" href="/til/assets/js/27.cbcdcc8f.js"><link rel="prefetch" href="/til/assets/js/28.61a95658.js"><link rel="prefetch" href="/til/assets/js/29.c4b73433.js"><link rel="prefetch" href="/til/assets/js/3.b01aaf25.js"><link rel="prefetch" href="/til/assets/js/30.b77a5716.js"><link rel="prefetch" href="/til/assets/js/31.d69f2ad3.js"><link rel="prefetch" href="/til/assets/js/32.ca6ba53c.js"><link rel="prefetch" href="/til/assets/js/33.6a2e1bc9.js"><link rel="prefetch" href="/til/assets/js/34.095a46be.js"><link rel="prefetch" href="/til/assets/js/35.ca1455b4.js"><link rel="prefetch" href="/til/assets/js/36.bc91cead.js"><link rel="prefetch" href="/til/assets/js/38.f397ac9b.js"><link rel="prefetch" href="/til/assets/js/39.04bde438.js"><link rel="prefetch" href="/til/assets/js/40.3e50caa2.js"><link rel="prefetch" href="/til/assets/js/41.488bb698.js"><link rel="prefetch" href="/til/assets/js/42.9244e7ad.js"><link rel="prefetch" href="/til/assets/js/43.8b682385.js"><link rel="prefetch" href="/til/assets/js/44.d6903500.js"><link rel="prefetch" href="/til/assets/js/45.8bdee6a1.js"><link rel="prefetch" href="/til/assets/js/46.4413a2a7.js"><link rel="prefetch" href="/til/assets/js/47.c76c3e43.js"><link rel="prefetch" href="/til/assets/js/48.5801339d.js"><link rel="prefetch" href="/til/assets/js/49.927f020a.js"><link rel="prefetch" href="/til/assets/js/5.728d0934.js"><link rel="prefetch" href="/til/assets/js/50.3984e3b0.js"><link rel="prefetch" href="/til/assets/js/51.533b0d50.js"><link rel="prefetch" href="/til/assets/js/52.1c0e975d.js"><link rel="prefetch" href="/til/assets/js/53.f8f69cf1.js"><link rel="prefetch" href="/til/assets/js/54.b053da38.js"><link rel="prefetch" href="/til/assets/js/55.d35f62b3.js"><link rel="prefetch" href="/til/assets/js/56.bca0105c.js"><link rel="prefetch" href="/til/assets/js/57.d1905609.js"><link rel="prefetch" href="/til/assets/js/58.73eecba7.js"><link rel="prefetch" href="/til/assets/js/59.3ed1b397.js"><link rel="prefetch" href="/til/assets/js/6.2215afbb.js"><link rel="prefetch" href="/til/assets/js/60.8540e2d7.js"><link rel="prefetch" href="/til/assets/js/61.f769d9da.js"><link rel="prefetch" href="/til/assets/js/62.a90fdfd4.js"><link rel="prefetch" href="/til/assets/js/63.42fe8209.js"><link rel="prefetch" href="/til/assets/js/64.a637646c.js"><link rel="prefetch" href="/til/assets/js/65.778c5832.js"><link rel="prefetch" href="/til/assets/js/66.ea5dc8fe.js"><link rel="prefetch" href="/til/assets/js/67.ac8e24d8.js"><link rel="prefetch" href="/til/assets/js/68.ab7788cb.js"><link rel="prefetch" href="/til/assets/js/69.053a13f0.js"><link rel="prefetch" href="/til/assets/js/7.da350833.js"><link rel="prefetch" href="/til/assets/js/70.083fd8f7.js"><link rel="prefetch" href="/til/assets/js/71.48fbfdf4.js"><link rel="prefetch" href="/til/assets/js/72.c0ffb38c.js"><link rel="prefetch" href="/til/assets/js/73.f5f2e53b.js"><link rel="prefetch" href="/til/assets/js/74.0c540003.js"><link rel="prefetch" href="/til/assets/js/75.feee75b2.js"><link rel="prefetch" href="/til/assets/js/76.ce77c7ae.js"><link rel="prefetch" href="/til/assets/js/77.d6187e57.js"><link rel="prefetch" href="/til/assets/js/78.0b30cad0.js"><link rel="prefetch" href="/til/assets/js/8.bdc8f610.js"><link rel="prefetch" href="/til/assets/js/9.72af91b4.js">
    <link rel="stylesheet" href="/til/assets/css/0.styles.bf2a48be.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/til/" class="home-link router-link-active"><!----> <span class="site-name">Today Youngjun learned✍</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/jun108059/til" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dev-youngjun.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/jun108059/til" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dev-youngjun.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>🐳 Docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/til/docker/00.WhatIsDocker.html" class="sidebar-link">Docker란?</a></li><li><a href="/til/docker/01.Docker-installation.html" aria-current="page" class="active sidebar-link">도커 설치하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#linux" class="sidebar-link">Linux</a></li><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#sudo-없이-사용하기" class="sidebar-link">sudo 없이 사용하기</a></li><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#docker-for-mac-docker-for-windows" class="sidebar-link">Docker for Mac / Docker for Windows</a></li><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#가상머신에-설치하기" class="sidebar-link">가상머신에 설치하기</a></li><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#설치확인하기" class="sidebar-link">설치확인하기</a></li><li class="sidebar-sub-header"><a href="/til/docker/01.Docker-installation.html#컨테이너-실행하기" class="sidebar-link">컨테이너 실행하기</a></li></ul></li><li><a href="/til/docker/02.Docker-installation-2.html" class="sidebar-link">도커 기본 명령어</a></li><li><a href="/til/docker/03.Docker-Practice.html" class="sidebar-link">Docker 이미지 만들고 배포하기</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🐋 Kubernetes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📘 Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📗 GCP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📙 Machine Learning</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📕 Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💚 Data Structure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>❤ Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💙 Kubeflow</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🖤 News</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💜 NGINX</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🤍 Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🤎 System Programming</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💛 UX&amp;UI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💕 Web</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="도커-설치하기"><a href="#도커-설치하기" class="header-anchor">#</a> 도커 설치하기</h1> <p><img src="/docs/.vuepress/public/images/img-docker/docker-logo.png" alt="img"></p> <p>도커는 리눅스 컨테이너 기술이므로 macOS나 windows에 설치할 경우 가상머신에 설치가 됨</p> <blockquote><p>리눅스 컨테이너 말고 윈도우즈 컨테이너라는 것도 있지만 리눅스 컨테이너를 사용할 예정!</p></blockquote> <h2 id="linux"><a href="#linux" class="header-anchor">#</a> Linux</h2> <p>리눅스에 도커를 설치하는 방법은 자동 설치 스크립트를 이용하는 것이 가장 쉽다. 다음 명령어를 입력하면 root 권한을 요구하고 잠시 기다리면 설치가 완료된다.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -fsSL https://get.docker.com/ <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">sh</span>
</code></pre></div><h2 id="sudo-없이-사용하기"><a href="#sudo-없이-사용하기" class="header-anchor">#</a> sudo 없이 사용하기</h2> <p>docker는 기본적으로 root권한이 필요하다. root가 아닌 사용자가 sudo없이 사용하려면 해당 사용자를 docker그룹에 추가하면 된다.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">usermod</span> -aG docker <span class="token environment constant">$USER</span> <span class="token comment"># 현재 접속중인 사용자에게 권한주기</span>
<span class="token function">sudo</span> <span class="token function">usermod</span> -aG docker your-user <span class="token comment"># your-user 사용자에게 권한주기</span>
</code></pre></div><p>사용자가 로그인 중이라면 다시 로그인 후 권한이 적용된다.</p> <h2 id="docker-for-mac-docker-for-windows"><a href="#docker-for-mac-docker-for-windows" class="header-anchor">#</a> Docker for Mac / Docker for Windows</h2> <p>도커를 맥이나 윈도우즈에 설치하려면 Docker for mac 또는 Docker for windows를 설치하면 된다. 파일을 다운받고 설치하고 재부팅하면 대부분 문제없이 완료된다. 소소한 옵션들이 있는데 특별히 건드릴 부분은 없으나 한번 살펴보고 적절하게 설정하면 된다. (windows는 공유 드라이브를 선택!)</p> <p><img src="/docs/.vuepress/public/images/img-docker/docker-for-mac.png" alt="img"></p> <p>마치 네이티브스럽게 설치된 것 같지만 도커는 리눅스 컨테이너이므로 실제로는 가상머신에 설치가 되었다. 사용자는 가상머신을 사용한다는 느낌이 전혀 안드는데 그런부분을 굉장히 신경써서 설계한 것 같다. 예를 들면, 포트를 연결하기 위해 도커 컨테이너의 특정 포트를 가상머신에 연결하고 다시 mac이나 windows의 포트와 연결해야 한다. 디렉토리를 연결한다면 디렉토리를 가상머신과 공유하고 그 디렉토리를 다시 컨테이너와 연결해야 한다. 이런 한단계 추가적으로 거쳐야하는 부분을 자연스럽게 처리해준다!</p> <blockquote><p>docker for mac은 xhyve라는 macOS에서 제공하는 가상환경을 이용하고 docker for windows는 Hyper-V기능을 이용한다. 따라서 OS가 최신버전이 아니면 동작하지 않을 수 있다.</p></blockquote> <h2 id="가상머신에-설치하기"><a href="#가상머신에-설치하기" class="header-anchor">#</a> 가상머신에 설치하기</h2> <p>이런저런 이유로 Docker for … 를 사용하지 못하는 경우 Docker machine을 이용할 수 있는데 처음 도커를 공부하는 경우에는 Virtual Box나 VMware같은 가상머신에 리눅스를 설치하고 리눅스에 접속하여 도커를 사용하는 방법을 권장함. 처음부터 Docker machine을 사용하면 환경이 약간 혼란스러울 수 있다.</p> <h2 id="설치확인하기"><a href="#설치확인하기" class="header-anchor">#</a> 설치확인하기</h2> <p>설치가 완료되었다면 정상적으로 설치되었는지 도커 명령어를 입력해 확인!</p> <div class="language- extra-class"><pre class="language-text"><code>docker version
</code></pre></div><p>output:</p> <div class="language- extra-class"><pre class="language-text"><code>Client:
 Version:      1.12.6
 API version:  1.24
 Go version:   go1.6.4
 Git commit:   78d1802
 Built:        Wed Jan 11 00:23:16 2017
 OS/Arch:      darwin/amd64

Server:
 Version:      1.12.6
 API version:  1.24
 Go version:   go1.6.4
 Git commit:   78d1802
 Built:        Wed Jan 11 00:23:16 2017
 OS/Arch:      linux/amd64
</code></pre></div><p>Client와 Server 정보가 정상적으로 출력되었다면 설치 완료!</p> <blockquote><p>Server 정보가 안나오고 <code>Error response from daemon: Bad response from Docker engine</code>이라는 메시지가 출력되는 경우는 보통 docker daemon이 정상적으로 실행되지 않았거나 <code>sudo</code>를 입력하지 않은 경우.</p></blockquote> <p>버전 정보가 클라이언트와 서버로 나뉘어져 있는데, 도커는 하나의 실행 파일이지만 실제로 클라이언트와 서버역할을 각각 할 수 있다! 도커 커맨드를 입력하면 도커 클라이언트가 도커 서버로 명령을 전송하고 결과를 받아 터미널에 출력해 준다.</p> <p><img src="/docs/.vuepress/public/images/img-docker/docker-client-host.png" alt="img"></p> <p>기본값이 도커 서버의 소켓을 바라보고 있기 때문에 사용자는 의식하지 않고 마치 바로 명령을 내리는 것 같은 느낌을 받는다. 이러한 설계가 mac이나 windows의 터미널에서 명령어를 입력했을때 <strong>가상 서버에 설치된 도커가 동작하는 이유</strong>이다.</p> <h2 id="컨테이너-실행하기"><a href="#컨테이너-실행하기" class="header-anchor">#</a> 컨테이너 실행하기</h2> <p>도커를 실행하는 명령어는 다음과 같다.</p> <div class="language- extra-class"><pre class="language-text"><code>docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]
</code></pre></div><p>다음은 자주 사용하는 옵션들이다.</p> <table border="1" data-ke-style="style12" style="border-collapse:collapse;width:92.7907%;height:324px;"><tbody><tr style="height:19px;"><td style="height:19px;width:50.016%;">옵션</td><td style="height:19px;width:49.7514%;">설명</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">-d</td><td style="height:19px;width:49.7514%;">detached mode 흔히 말하는 백그라운드 모드</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">-p</td><td style="height:19px;width:49.7514%;">호스트와 컨테이너의 포트를 연결 (포워딩)</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">-v</td><td style="height:19px;width:49.7514%;">호스트와 컨테이너의 디렉토리를 연결 (마운트)</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">-e</td><td style="height:19px;width:49.7514%;">컨테이너 내에서 사용할 환경변수 설정</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">–name</td><td style="height:19px;width:49.7514%;">컨테이너 이름 설정</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">–rm</td><td style="height:19px;width:49.7514%;">프로세스 종료시 컨테이너 자동 제거</td></tr><tr style="height:19px;"><td style="height:19px;width:50.016%;">-it</td><td style="height:19px;width:49.7514%;">-i와 -t를 동시에 사용한 것으로 터미널 입력을 위한 옵션</td></tr><tr style="height:10px;"><td style="height:10px;width:50.016%;">–link</td><td style="height:10px;width:49.7514%;">컨테이너 연결 [컨테이너명:별칭]</td></tr></tbody></table> <p>엄청나게 직관적인 옵션으로 몇번 실행해보면 자연스럽게 익숙해진다.</p> <h4 id="ubuntu-16-04-container"><a href="#ubuntu-16-04-container" class="header-anchor">#</a> ubuntu 16.04 container</h4> <p>시작은 가볍게 ubuntu 16.04 컨테이너를 생성하고 컨테이너 내부에 들어가 봅니다.</p> <div class="language- extra-class"><pre class="language-text"><code>docker run ubuntu:16.04
</code></pre></div><blockquote><p>이미지를 처음 다운받는 경우</p></blockquote> <p>run명령어를 사용하면 사용할 이미지가 저장되어 있는지 확인하고 없다면 다운로드(pull)를 한 후 컨테이너를 생성(create)하고 시작(start) 한다.</p> <p>ubuntu:16.04이미지를 다운받은 적이 없으면 이미지를 다운로드 한 후 컨테이너가 실행된다. 컨테이너는 정상적으로 실행됐지만 뭘 하라고 명령어를 전달하지 않았기 때문에 컨테이너는 생성되자마자 종료된다. <strong>컨테이너는 프로세스이기 때문에 실행중인 프로세스가 없으면 컨테이너는 종료된다.</strong></p> <p>이번에는/bin/bash명령어를 입력해서ubuntu:16.04컨테이너를 실행해보자.</p> <div class="language- extra-class"><pre class="language-text"><code>docker run --rm -it ubuntu:16.04 /bin/bash

# in container
$ cat /etc/issue
Ubuntu 16.04.1 LTS \n \l

$ ls
bin   dev  home  lib64  mnt  proc  run   srv  tmp  var
boot  etc  lib   media  opt  root  sbin  sys  usr
</code></pre></div><p>컨테이너 내부에 들어가기 위해 bash 쉘을 실행하고 키보드 입력을 위해-it옵션주고, 프로세스가 종료되면 컨테이너가 자동으로 삭제되도록--rm옵션도 추가한다. 다운로드가 되어있기 때문에 이미지를 다운로드 하는 화면 없이 바로 실행된다.  cat /etc/issue와ls를 실행해보면 ubuntu 리눅스인걸 알 수 있다! (가벼운 가상머신 느낌)</p> <p>exit로 bash 쉘을 종료하면 컨테이너도 같이 종료된다. 도커를 이용하여 가장 기본적인 컨테이너를 순식간에 만들어 보았다.</p> <h4 id="redis-container"><a href="#redis-container" class="header-anchor">#</a> redis container</h4> <p>2번째 컨테이너는redis 이다.<a href="https://redis.io/" target="_blank" rel="noopener noreferrer">redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>는 메모리기반의 다양한 기능을 가진 스토리지이다! 6379 포트로 통신하며 telnet 명령어로 테스트해 볼 수 있다. redis 컨테이너는 detached mode(백그라운드 모드)로 실행하기 위해-d옵션을 추가하고-p옵션을 추가하여 컨테이너의 포트를 호스트의 포트로 연결해보았다.</p> <blockquote><p>-d옵션이 없다면 프로세스가 foreground로 실행되어 아무키도 입력할 수 없게 된다.<br>
컨테이너를 종료하려면ctrl + c를 입력하자.</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>docker run -d -p 1234:6379 redis
5dff91d2cd859b48806231627aadf2066b9b10a8687c765b71ae6cae834ed751

# redis test
$ telnet localhost 1234
set mykey hello
+OK
get mykey
$5
hello
</code></pre></div><p>-d옵션을 주었기 때문에 컨테이너를 실행하자마자 컨테이너의 ID(5dff91d2…)를 보여주고 바로 쉘로 돌아왔다. 컨테이너는 종료된 것이 아니라 백그라운드 모드로 동작하고 있고 컨테이너 ID를 이용하여 컨테이너를 제어할 수 있다.-p옵션을 이용하여 호스트의1234포트를 컨테이너의6379포트로 연결하였고 localhost의 1234포트로 접속하면 하면 redis를 사용할 수 있다.</p> <p>테스트 결과 redis에 접속하여 새로운 키를 저장하고 불러오는데 성공했다. 실행이 간단한건 물론이고 호스트의 포트만 다르게 하면 하나의 서버에 여러개의 redis 서버를 띄우는 것도 매우 간단하다.</p> <h4 id="mysql-5-7-container"><a href="#mysql-5-7-container" class="header-anchor">#</a> MySQL 5.7 container</h4> <p>3번째 실행할 컨테이너는MySQL 서버이다. 가장 흔하게 사용하는 데이터베이스인데 이번에는-e옵션을 이용하여 환경변수를 설정하고--name옵션을 이용하여 컨테이너에 읽기 어려운 ID 대신 쉬운 이름을 부여할 예정이다.</p> <blockquote><p>--name옵션을 생략하면 도커가 자동으로 이름을 지어 줍니다. 이름은 유명한 과학자나 해커의 이름과 수식어를 조합하여 랜덤으로<a href="https://github.com/docker/docker/blob/master/pkg/namesgenerator/names-generator.go" target="_blank" rel="noopener noreferrer">생성<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>합니다. (ex - boring_wozniak) 우리나라 과학자<a href="https://github.com/docker/docker/issues/8996" target="_blank" rel="noopener noreferrer">장영실<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>도 등록되어 있습니다.</p></blockquote> <p><a href="https://hub.docker.com/_/mysql/" target="_blank" rel="noopener noreferrer">MySQL Docker hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>페이지에 접속하면 간단한 사용법과 환경변수에 대한 설명이 있다. 여러가지 설정값이 있는데 패스워드 없이 root계정을 만들기 위해MYSQL_ALLOW_EMPTY_PASSWORD환경변수를 설정한다. 그리고 컨테이너의 이름은mysql로 할당하고 백그라운드 모드로 띄우기 위해-d옵션을 준다. 포트는3306포트를 호스트에서 그대로 사용하겠다.</p> <div class="language- extra-class"><pre class="language-text"><code>docker run -d -p 3306:3306 \
  -e MYSQL_ALLOW_EMPTY_PASSWORD=true \
  --name mysql \
  mysql:5.7

# MySQL test
$ mysql -h127.0.0.1 -uroot

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)

mysql&gt; quit
</code></pre></div><p>순식간에 MySQL서버가 실행되었습니다. 이번 테스트는 호스트 OS에 MySQL 클라이언트가 설치되어 있어야 한다. 추후에 실행중인 MySQL 도커 컨테이너에 접속하여 클라이언트를 실행해 보도록 하겠다.</p> <p>처음 접속 시도시 에러가 날 경우 MySQL 서버가 최초로 실행되면서 준비작업을 하기 때문에 발생하는 에러이다. 컨테이너를 실행하면 백그라운드에서 MySQL 서버를 띄우는 시간이 필요하기 때문에 잠시 후에 다시 시도 했을 때 정상적으로 접속된 걸 확인할 수 있을 것이다.</p> <h3 id="wordpress-container"><a href="#wordpress-container" class="header-anchor">#</a> WordPress container</h3> <p>이번에는 블로그엔진으로 유명한<a href="https://wordpress.com/" target="_blank" rel="noopener noreferrer">워드프레스<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>를 실행한다. 워드프레스는 데이터베이스가 필요하기 때문에 조금 복잡한 형태를 띄지만 크게 어렵지 않다. 바로 전에 생성했던 MySQL 컨테이너에 워드프레스 데이터베이스를 만들고 WordPress 컨테이너를 실행할 때--link옵션을 이용하여 MySQL 컨테이너를 연결해보겠다.</p> <p>--link옵션은 환경변수와 IP정보를 공유하는데 링크한 컨테이너의 IP정보를/etc/hosts에 자동으로 입력하므로 워드프레스 컨테이너가 MySQL 데이터베이스의 정보를 알 수 있게 된다!</p> <p>먼저, 워드프레스용 데이터베이스를 생성하고 워드프레스 컨테이너를 실행한다. 호스트의8080포트를 컨테이너의80포트로 연결하고 MySQL 컨테이너와 연결한 후 각종 데이터베이스 설정 정보를 환경변수로 입력한다.</p> <div class="language- extra-class"><pre class="language-text"><code># create mysql database
$ mysql -h127.0.0.1 -uroot
create database wp CHARACTER SET utf8;
grant all privileges on wp.* to wp@'%' identified by 'wp';
flush privileges;
quit

# run wordpress container
docker run -d -p 8080:80 \
  --link mysql:mysql \
  -e WORDPRESS_DB_HOST=mysql \
  -e WORDPRESS_DB_NAME=wp \
  -e WORDPRESS_DB_USER=wp \
  -e WORDPRESS_DB_PASSWORD=wp \
  wordpress
</code></pre></div><p>컨테이너가 제대로 실행되었는지 웹 브라우저로 확인해보자.</p> <p><img src="/docs/.vuepress/public/images/img-docker/wordpress-setup.png" alt="img"></p> <p>워드프레스가 실행되었다! 단지 이미지를 다운받고 적절한 환경변수를 입력하여 컨테이너를 실행했고, 워드프레스 컨테이너 내부는 apache2와 php가 설치되어 있지만 추상화되어 있어 실행과정에서는 드러나지 않는다.</p> <blockquote><p>이번 예제는 테스트용으로만 사용해야 합니다. 운영 환경에서 사용하려면 추가적인 셋팅이 필요합니다. 이부분은 밑에서 다시 다룹니다.</p></blockquote> <blockquote><p>--link옵션은 deprecated 되어 곧 사용할 수 없습니다. 대신 Docker network 기능을 이용해야 하지만 쉬운 이해를 돕기 위해 사용하였습니다.</p></blockquote> <p>이제, 원하는 서비스가 있다면 이미지를 찾거나 직접 만들고, 어디서나 손쉽게 서비스를 실행할 수 있을 것이다.</p> <h4 id="tensorflow"><a href="#tensorflow" class="header-anchor">#</a> tensorflow</h4> <p>마지막으로 이렇게 활용할 수 있다라는 예제로 tensorflow를 실행보도록 하겠다.<a href="https://www.tensorflow.org/" target="_blank" rel="noopener noreferrer">tensorflow<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>는 손쉽게 머신러닝을 할 수 있는 툴이다. tensorflow는 python으로 만들어져 python과 관련 패키지를 설치해야 한다. 이번에 설치하는 이미지는 python과 함께 numpy, scipy, pandas, jupyter, scikit-learn, gensim, BeautifulSoup4, Tensorflow가 설치되어 있다. 뭔가 복잡해 보이지만 도커라면 손쉽게 실행해 볼 수 있다.</p> <div class="language- extra-class"><pre class="language-text"><code>docker run -d -p 8888:8888 -p 6006:6006 teamlab/pydata-tensorflow:0.1
</code></pre></div><p>설치된 파일이 많아 다운로드 하는데 시간이 좀 걸린다. 컨테이너가 실행되면 웹 브라우저에서 jupyter에 접속하여 머신러닝을 시작해 보자!</p> <p><img src="/docs/.vuepress/public/images/img-docker/tensorflow.png" alt="img"></p> <p>성공적으로 tensorflow 테스트를 마쳤다. 여기까지 ubuntu, MySQL, redis, Wordpress, tensorflow를 실행해 보았다. 가상머신을 이용해서 동일한 작업을 했다면 컴퓨터가 엄청나게 버벅이기 시작했겠지만 컨테이너 기반의 도커를 이용하여 매우 가볍게 실행하고 있다. 내부 구조나 설치과정은 자세히 모르지만, 간단한 도커 명령어로 여러개의 서비스를 순식간에 실행하고 사용할 수 있다니 정말 최고다.</p> <h3 id="reference"><a href="#reference" class="header-anchor">#</a> Reference</h3> <p>초보를 위한 도커 안내서 - 설치하고 컨테이너 실행하기</p> <p><a href="https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0-exec" target="_blank" rel="noopener noreferrer">https://subicura.com/2017/01/19/docker-guide-for-beginners-2.html#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%8B%A4%ED%96%89%ED%95%98%EA%B8%B0-exec<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/17/2020, 3:28:32 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/til/docker/00.WhatIsDocker.html" class="prev">
        Docker란?
      </a></span> <span class="next"><a href="/til/docker/02.Docker-installation-2.html">
        도커 기본 명령어
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/til/assets/js/app.00b9b90c.js" defer></script><script src="/til/assets/js/2.2e6f6d7d.js" defer></script><script src="/til/assets/js/37.9007b1f9.js" defer></script><script src="/til/assets/js/4.5194b884.js" defer></script>
  </body>
</html>
