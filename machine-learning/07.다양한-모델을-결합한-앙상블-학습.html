<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>7장 다양한 모델을 결합한 앙상블 학습 | Today Youngjun learned✍</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/til/images/logo-144.png">
    <link rel="manifest" href="/til/manifest.json">
    <meta name="description" content="Youngjun`s Personal Wiki (Today I Learned)">
    
    <link rel="preload" href="/til/assets/css/0.styles.5b85764b.css" as="style"><link rel="preload" href="/til/assets/js/app.db613388.js" as="script"><link rel="preload" href="/til/assets/js/2.f827bc55.js" as="script"><link rel="preload" href="/til/assets/js/3.523a327b.js" as="script"><link rel="preload" href="/til/assets/js/46.01e6df54.js" as="script"><link rel="prefetch" href="/til/assets/js/10.d7bebace.js"><link rel="prefetch" href="/til/assets/js/100.c4c5d489.js"><link rel="prefetch" href="/til/assets/js/101.b68ce192.js"><link rel="prefetch" href="/til/assets/js/102.5669c6e9.js"><link rel="prefetch" href="/til/assets/js/103.5bfa6597.js"><link rel="prefetch" href="/til/assets/js/104.80865abc.js"><link rel="prefetch" href="/til/assets/js/105.d4b6ee29.js"><link rel="prefetch" href="/til/assets/js/106.bfc58b9a.js"><link rel="prefetch" href="/til/assets/js/107.94230b50.js"><link rel="prefetch" href="/til/assets/js/108.5f216130.js"><link rel="prefetch" href="/til/assets/js/109.51e245f9.js"><link rel="prefetch" href="/til/assets/js/11.af453223.js"><link rel="prefetch" href="/til/assets/js/110.8ca4309a.js"><link rel="prefetch" href="/til/assets/js/111.bc804496.js"><link rel="prefetch" href="/til/assets/js/112.c60a0917.js"><link rel="prefetch" href="/til/assets/js/113.830f3786.js"><link rel="prefetch" href="/til/assets/js/114.d3993c2e.js"><link rel="prefetch" href="/til/assets/js/115.b4929715.js"><link rel="prefetch" href="/til/assets/js/116.1fd08ec1.js"><link rel="prefetch" href="/til/assets/js/117.2a1c47b1.js"><link rel="prefetch" href="/til/assets/js/118.38ba08b9.js"><link rel="prefetch" href="/til/assets/js/119.320ea3f4.js"><link rel="prefetch" href="/til/assets/js/12.26021412.js"><link rel="prefetch" href="/til/assets/js/120.a585aa3b.js"><link rel="prefetch" href="/til/assets/js/121.2c826722.js"><link rel="prefetch" href="/til/assets/js/122.da4f6f2f.js"><link rel="prefetch" href="/til/assets/js/123.6aca698b.js"><link rel="prefetch" href="/til/assets/js/124.ce2b3f2e.js"><link rel="prefetch" href="/til/assets/js/125.7606400e.js"><link rel="prefetch" href="/til/assets/js/126.39b878a4.js"><link rel="prefetch" href="/til/assets/js/127.c453aa60.js"><link rel="prefetch" href="/til/assets/js/128.afb353a5.js"><link rel="prefetch" href="/til/assets/js/129.bf19be2b.js"><link rel="prefetch" href="/til/assets/js/13.36b91a88.js"><link rel="prefetch" href="/til/assets/js/130.30e5edd2.js"><link rel="prefetch" href="/til/assets/js/131.d6272b2a.js"><link rel="prefetch" href="/til/assets/js/132.9d22e29e.js"><link rel="prefetch" href="/til/assets/js/133.b35a3ca3.js"><link rel="prefetch" href="/til/assets/js/134.6fcca999.js"><link rel="prefetch" href="/til/assets/js/135.ece88eb3.js"><link rel="prefetch" href="/til/assets/js/136.d70ce4da.js"><link rel="prefetch" href="/til/assets/js/137.cfc76a2a.js"><link rel="prefetch" href="/til/assets/js/138.d4e392d6.js"><link rel="prefetch" href="/til/assets/js/139.8aa0e362.js"><link rel="prefetch" href="/til/assets/js/14.21d198f0.js"><link rel="prefetch" href="/til/assets/js/140.ae265b77.js"><link rel="prefetch" href="/til/assets/js/141.7435132e.js"><link rel="prefetch" href="/til/assets/js/142.8f412df1.js"><link rel="prefetch" href="/til/assets/js/143.ea3dd2a6.js"><link rel="prefetch" href="/til/assets/js/15.a0350cec.js"><link rel="prefetch" href="/til/assets/js/16.04d05a5a.js"><link rel="prefetch" href="/til/assets/js/17.92966275.js"><link rel="prefetch" href="/til/assets/js/18.0d484a85.js"><link rel="prefetch" href="/til/assets/js/19.ce64e38d.js"><link rel="prefetch" href="/til/assets/js/20.5c8846a0.js"><link rel="prefetch" href="/til/assets/js/21.2e485fd8.js"><link rel="prefetch" href="/til/assets/js/22.083d91dc.js"><link rel="prefetch" href="/til/assets/js/23.a79ef9c9.js"><link rel="prefetch" href="/til/assets/js/24.1c53e189.js"><link rel="prefetch" href="/til/assets/js/25.43488937.js"><link rel="prefetch" href="/til/assets/js/26.cfda8508.js"><link rel="prefetch" href="/til/assets/js/27.04675916.js"><link rel="prefetch" href="/til/assets/js/28.201dabcb.js"><link rel="prefetch" href="/til/assets/js/29.4afa5744.js"><link rel="prefetch" href="/til/assets/js/30.f00fd4d5.js"><link rel="prefetch" href="/til/assets/js/31.e2302d67.js"><link rel="prefetch" href="/til/assets/js/32.20d8b662.js"><link rel="prefetch" href="/til/assets/js/33.ae5e8e46.js"><link rel="prefetch" href="/til/assets/js/34.32525616.js"><link rel="prefetch" href="/til/assets/js/35.c2833f9c.js"><link rel="prefetch" href="/til/assets/js/36.14d0f3bc.js"><link rel="prefetch" href="/til/assets/js/37.d923853e.js"><link rel="prefetch" href="/til/assets/js/38.d261d060.js"><link rel="prefetch" href="/til/assets/js/39.239a50af.js"><link rel="prefetch" href="/til/assets/js/4.45c650f4.js"><link rel="prefetch" href="/til/assets/js/40.2d9bc2a1.js"><link rel="prefetch" href="/til/assets/js/41.caa07bae.js"><link rel="prefetch" href="/til/assets/js/42.45690ce9.js"><link rel="prefetch" href="/til/assets/js/43.825c1580.js"><link rel="prefetch" href="/til/assets/js/44.d44576a6.js"><link rel="prefetch" href="/til/assets/js/45.d7545ef2.js"><link rel="prefetch" href="/til/assets/js/47.1fbcadb6.js"><link rel="prefetch" href="/til/assets/js/48.2b9b1509.js"><link rel="prefetch" href="/til/assets/js/49.494fbd72.js"><link rel="prefetch" href="/til/assets/js/5.0aa337fe.js"><link rel="prefetch" href="/til/assets/js/50.b3e0241f.js"><link rel="prefetch" href="/til/assets/js/51.497b25e7.js"><link rel="prefetch" href="/til/assets/js/52.079e17c0.js"><link rel="prefetch" href="/til/assets/js/53.d15109f5.js"><link rel="prefetch" href="/til/assets/js/54.d9dc8d80.js"><link rel="prefetch" href="/til/assets/js/55.a9fe476d.js"><link rel="prefetch" href="/til/assets/js/56.5b7c8e8e.js"><link rel="prefetch" href="/til/assets/js/57.7b163896.js"><link rel="prefetch" href="/til/assets/js/58.2ca7da5b.js"><link rel="prefetch" href="/til/assets/js/59.926b192a.js"><link rel="prefetch" href="/til/assets/js/6.52e5f234.js"><link rel="prefetch" href="/til/assets/js/60.221c2169.js"><link rel="prefetch" href="/til/assets/js/61.d1814565.js"><link rel="prefetch" href="/til/assets/js/62.2c62fe16.js"><link rel="prefetch" href="/til/assets/js/63.64d19172.js"><link rel="prefetch" href="/til/assets/js/64.45e22399.js"><link rel="prefetch" href="/til/assets/js/65.4c350e04.js"><link rel="prefetch" href="/til/assets/js/66.5a834cf8.js"><link rel="prefetch" href="/til/assets/js/67.d1c48057.js"><link rel="prefetch" href="/til/assets/js/68.77fbd198.js"><link rel="prefetch" href="/til/assets/js/69.90e61771.js"><link rel="prefetch" href="/til/assets/js/7.21123317.js"><link rel="prefetch" href="/til/assets/js/70.a784e544.js"><link rel="prefetch" href="/til/assets/js/71.493fbe0d.js"><link rel="prefetch" href="/til/assets/js/72.3746d801.js"><link rel="prefetch" href="/til/assets/js/73.781612ad.js"><link rel="prefetch" href="/til/assets/js/74.26c52c69.js"><link rel="prefetch" href="/til/assets/js/75.497152ea.js"><link rel="prefetch" href="/til/assets/js/76.833f719f.js"><link rel="prefetch" href="/til/assets/js/77.c68bb56f.js"><link rel="prefetch" href="/til/assets/js/78.e88b5208.js"><link rel="prefetch" href="/til/assets/js/79.d3f74adf.js"><link rel="prefetch" href="/til/assets/js/8.bc2662d1.js"><link rel="prefetch" href="/til/assets/js/80.ae9f20ce.js"><link rel="prefetch" href="/til/assets/js/81.edc4bc43.js"><link rel="prefetch" href="/til/assets/js/82.c38528d6.js"><link rel="prefetch" href="/til/assets/js/83.3faadb6e.js"><link rel="prefetch" href="/til/assets/js/84.d8a552da.js"><link rel="prefetch" href="/til/assets/js/85.55f502c3.js"><link rel="prefetch" href="/til/assets/js/86.c493861b.js"><link rel="prefetch" href="/til/assets/js/87.1bb57bd2.js"><link rel="prefetch" href="/til/assets/js/88.2d238be1.js"><link rel="prefetch" href="/til/assets/js/89.81f41fd8.js"><link rel="prefetch" href="/til/assets/js/9.1d59b63f.js"><link rel="prefetch" href="/til/assets/js/90.db78fbe7.js"><link rel="prefetch" href="/til/assets/js/91.9074b2eb.js"><link rel="prefetch" href="/til/assets/js/92.57b5abb5.js"><link rel="prefetch" href="/til/assets/js/93.325238be.js"><link rel="prefetch" href="/til/assets/js/94.b9819f7d.js"><link rel="prefetch" href="/til/assets/js/95.2bd5be66.js"><link rel="prefetch" href="/til/assets/js/96.f7ec3a35.js"><link rel="prefetch" href="/til/assets/js/97.f6c12817.js"><link rel="prefetch" href="/til/assets/js/98.542b0796.js"><link rel="prefetch" href="/til/assets/js/99.cc724f32.js">
    <link rel="stylesheet" href="/til/assets/css/0.styles.5b85764b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/til/" class="home-link router-link-active"><!----> <span class="site-name">Today Youngjun learned✍</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/jun108059/til" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dev-youngjun.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/jun108059/til" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://dev-youngjun.tistory.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🎨 Elasticsearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🐳 Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🐋 Kubernetes</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📘 Flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📗 GCP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>📙 Machine Learning</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/til/machine-learning/01.컴퓨터는-데이터에서-배운다.html" class="sidebar-link">1장 컴퓨터는 데이터에서 배운다</a></li><li><a href="/til/machine-learning/02.간단한-분류-알고리즘-훈련.html" class="sidebar-link">2장 간단한 분류 알고리즘 훈련</a></li><li><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html" class="active sidebar-link">7장 다양한 모델을 결합한 앙상블 학습</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-1-앙상블-학습" class="sidebar-link">7.1 앙상블 학습</a></li><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-2-다수결-투표를-사용한-분류-앙상블" class="sidebar-link">7.2 다수결 투표를 사용한 분류 앙상블</a></li><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-3-앙상블-분류기의-평가와-튜닝" class="sidebar-link">7.3 앙상블 분류기의 평가와 튜닝</a></li><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-3-배깅-부트스트랩-샘플링을-통한-분류-앙상블" class="sidebar-link">7.3 배깅 : 부트스트랩 샘플링을 통한 분류 앙상블</a></li><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-4-약한-학습기를-이용한-에이다부스트" class="sidebar-link">7.4 약한 학습기를 이용한 에이다부스트</a></li><li class="sidebar-sub-header"><a href="/til/machine-learning/07.다양한-모델을-결합한-앙상블-학습.html#_7-5-요약" class="sidebar-link">7.5 요약</a></li></ul></li><li><a href="/til/machine-learning/colab-github-demo.html" class="sidebar-link">Using Colab with GitHub</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📕 Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💚 Data Structure</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💝 Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💙 Kubeflow</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🖤 News</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💜 NGINX</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🤍 Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>🤎 System Programming</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💛 UX&amp;UI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>💕 Web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>📌 etc</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_7장-다양한-모델을-결합한-앙상블-학습"><a href="#_7장-다양한-모델을-결합한-앙상블-학습" class="header-anchor">#</a> 7장 다양한 모델을 결합한 앙상블 학습</h1> <blockquote><p>포스팅은 '머신러닝 교과서 with 파이썬, 사이킷런, 텐서플로' 교재로 공부하고 정리하여 작성하였습니다.</p></blockquote> <blockquote><p>다양한 분류 모델을 평가 &amp; 튜닝하는 기술을 토대로 분류기 집합을 구성하는 여러가지 방법을 살펴보자.</p></blockquote> <ul><li>다수결 투표를 기반으로 예측 만들기</li> <li>중복을 허용하여 랜덤하게 훈련 샘플을 뽑는 배깅(bagging)을 사용해서 과대적합 감소하기</li> <li>앞선 모델의 오차를 학습하는 약한 학습기(weak learner)로 구성된 부스팅(boosting)으로 강력한 모델 구축하기</li></ul> <h2 id="_7-1-앙상블-학습"><a href="#_7-1-앙상블-학습" class="header-anchor">#</a> 7.1 앙상블 학습</h2> <p><strong>앙상블 학습(ensemble learning)의 목표</strong></p> <p>여러 분류기를 <strong>하나의 메타 분류기로 연결</strong>하여 개별 분류기보다 더 좋은 일반화 성능을 달성하는 것</p> <blockquote><p>앙상블의 작동 원리와 높은 일반화 성능을 내는 이유에 대해 알아보자.</p></blockquote> <p>과반수 투표(majority voting) - 분류기의 과반수가 예측한 클래스 레이블을 선택하는 단순한 방법 (이진 클래스 분류)</p> <p>다수결 투표(plurality voting) - 가장 많은 투푤르 받은 클래스 레이블을 선택 (다중 클래스 일반화)</p> <p><img src="/til/assets/img/07-1.203bd6b2.png" alt="img"></p> <p>이 앙상블은 열개의 분류기로 구성 - 각각의 심볼(삼각형, 사각형, 원)은 고유한 클래스 레이블을 나타낸다.</p> <p>먼저 훈련 세트를 사용하여 m개의 다른 분류기(C₁ ~ Cm)를 훈련시킨다.</p> <blockquote><p>앙상블 방법에 따라 결정트리, 서포트 벡터머신, 로지스틱 회귀 분류기와 같은 여러가지 알고리즘으로 구축 가능<br>
또는 같은 분류 알고리즘을 사용하고 훈련 세트의 부분 집합(subset)을 달리하여 학습 가능</p></blockquote> <p>유명한 앙상블 방법 중 하나는 서로 다른 결정 트리를 연결한 랜덤 포레스트(random forest)이다.</p> <p><img src="/til/assets/img/07-2.4d056872.png" alt="img"></p> <p>그림 7-2는 과반수 투표를 사용한 일반적인 앙상블 방법이다.</p> <p><strong>과반수 투표나 다수결 투표로 클래스 레이블을 예측하려면</strong> 개별 분류기 Cj의 예측 레이블을 모아 가장 많은 표를 받은 레이블을 선택한다.</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmkAAAA3CAYAAABXat18AAAeAUlEQVR4Ae3dB7A1RdEGYBQFKSkkWKAgSaIEE6BIEBBRggQJggEkSBBBkSgYUDABSgaJikqWJBIElKBgAAUEJRgIkrMIGEDYv56pmu8f9tsT7j3nXvber6fq1Am7O9P9zuz0u909c6arogQCgUAgEAgEAoFAIBAItA6B6VonUQgUCAQCgUAgEAgEAoFAIFAFSYtBEAgEAoFAIBAIBAKBQAsRCJLWwk4JkQKBQCAQCAQCgUAgEAiSFmMgEAgEAoFAIBAIBAKBFiIQJK2FnRIiBQKBQCAQCAQCgUAgECQtxkAgEAgEAoFAIBAIBAItRCBIWgs7JUQKBAKBQCAQCAQCgUAgSFqMgUAgEAgEAoFAIBAIBFqIQJC0FnZKiBQIBAKBQCAQCAQCgUCQtBgDgUAgEAgEAoFAIBAItBCBIGkt7JQQKRAIBAKBQCAQCAQCgSBpMQYCgUAgEAgEAoFAIBBoIQJB0lrYKSFSINCEwP/+97/K64UXXmg6HL8FAoFADYHnn38+3TO1n+NrIDBhEAiSNmG6KgSdlhH497//Xd14443Vb3/72+o///nPtAxF6B4I9IWAh5knn3yy+vWvf13dfffdFcIWJRCYaAgESZtoPRbyTnMIIGgXXnhhdcQRRySD869//WtcMGDkvBi3Qbx3uZ5xEXrARrKsg+hLhFzPgOJM+ssHHVu9sP7HP/5RXXLJJdWBBx5Y3XrrrQON40nfGaFgKxEIktbKbgmhAoH/R+Daa6+ttttuu+r222+vnnvuuXEzNE8//XTyRPDe+TzagmSSfbzI5WjlRBieffbZ6oknnqj+9re/VeQebXHtX//61xfVMSjxG60sbb3OePjLX/5S3X///aMe0zD985//XD3++OONnjLHeZ4vuuiiau+9966eeeaZCH+2dUCEXI0IBElrhCV+HGsEGMQyv4pRCyM2Nepw+vznP18dcMABAxGlqWvu/cs///nP6rzzzqtOOumk6qmnnhp1/zDGvIAMpc90amMhF8/L97///ercc89NBn20YxIZOOGEE6rLL788ETX1wHMylNFiUuru3r/mmmuqb37zm4mkjXZMkIWX+bjjjqsefvjhxrHlHMc22mij6sorr0wPOqUs8TkQaDMCQdLa3DuTVDYT8l133VX9/ve/r+68885JPWnSlffL0/x///vfRiPSrZt5CNZZZ53q9NNPT9d3OzcfY5QYQe16ZTJMln4NrGsuvvjiRBAfe+yxEcudZfGuTf38ta99LdU5zJy6jG/WNeuY30s5en2m8w9/+MPqmGOOSWStX6ya6nXtHXfcUe2zzz4pRM1DR6aJVOjQhK/+G0SXjM3OO++cPJZwH6Qg/h4kDj/88OrRRx9trMq994lPfCI97BgrUQKBiYJAkLSJ0lOTSE5Gf8stt6ze/va3V9tvv31177339k0eJhoMyOhVV11VHXrooYkAjDRsKGS2/PLLJ09BL3LD+CED8LXI4LLLLqt+9rOfVdddd1113333pVe/CdR/+MMfqo9//OPVH//4x6GEh8h2xRVXVNtss00KT/k+SEESchhVvXT9xS9+Ud18882JYN12220jXmBB5y222CKFZgchIVkvxEA+1B577JHqzL+3/V3fIDLCvvA0hvJYMn4QIeHr0fYhr+wXv/jFET149MJMePrTn/509ZOf/KRxvLp3Nt100zTv6JcogcBEQSBI2kTpqUkipwny/PPPr3baaaf0VLvWWmtVZ599diIXk0TFF6kh58ZT/txzz52M9UhDXn/605+qhRZaKHkJeAw6FaTikUceSUTwU5/6VLXbbrulEOOZZ56ZPFjbbrtt9eEPf7j60Y9+1BNrxlcYascdd0yGerTGuC6r3CN5QV/96ldflKtVP6/bd7IgZ3D5+te/XtF1v/32q0488cTq+OOPr/bcc8+k52abbZZCXN3qKo+p80tf+lL1la98pWN+U3l+v5/1yWc+85nUFwh02wt8kTPhXnJ/9rOfTZ7F733vewkbxH2TTTZJ9+5oPGDGKTK98sorpweAYZBhmJLl6KOPrnbYYYfq73//+1Qw619zzYYbbti3R3qqSuKHQOAlQCBI2ksA+rTcJEN90EEHJa8OoyUvRZhCOGyyFnldb3rTm1LuzEif4nkI3vKWt1S77757Y04T48TrAb9dd921Wn311VPulzBpJleI4WmnnVa97W1vSzlm3YyraxDLFVZYoTr55JOHatC0K5y4yiqrVLfccsuoupsn8pRTTkkhYJjwfpXhq3vuuadaf/31q4997GOJbPXTCJ2zx5Lnq6yvn+u7nWOMIw8bbLBBWl3Y7dw2HONx3XfffROhOeOMM6qHHnpoSmgTLhdccEG1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" alt="img"></p> <p>예를 들어 class1 = -1이고 class2 = +1인 이진 분류 작업에서 과반수 투표 예측은 다음과 같다.</p> <p><img src="/til/assets/img/07-4.476dd9ff.png" alt="img"></p> <p><strong>앙상블 방법이 개별 분류기보다 성능이 뛰어난 이유?</strong></p> <p>간단한 조합 이론을 적용해 이해해 보자.</p> <p>이진 분류 작업</p> <ul><li>동일한 에러율(error rate)을 가진 n개의 분류기</li> <li>모든 분류기는 독립적, 발생하는 오차는 서로 상관관계 없음</li></ul> <p>이 분류기의 앙상블이 만드는 오차 확률을 이항 분포(binomial distribution)의 확률 질량 함수(probability mass function)로 표현할 수 있다.</p> <p><img src="/til/assets/img/07-5.70c6bebf.png" alt="img"></p> <p>여기서 ( n k )는 이항 계수(binomial coefficient)로 n개 원소에서 k개를 뽑는 조합의 가짓수</p> <p>▼ 이항 계수?</p> <p>크기가 n인 집합에서 순서를 고려하지 않고 k개의 부분 집합을 선택할 수 있는 방법을 나타낸다.</p> <p>순서에 상관없기 때문에 조합 또는 조합의 가짓수로 표현하기도 함</p> <p>이 식은 앙상블의 예측이 틀릴 확률을 계산한다.</p> <p>예를 들어 에러율이 0.25인 분류기 11개로 구성된 앙상블의 에러율은 다음과 같다.</p> <p><img src="/til/assets/img/07-6.1697972c.png" alt="img"></p> <p>앙상블의 에러율(0.034)은 개별 분류기의 에러율(0.25)보다 훨씬 낮다.</p> <p>이상적인 앙상블 분류기와 다양한 범위의 분류기를 가진 경우와 비교하기 위해 파이썬으로 확률 질량 함수를 구현해보았다.</p> <p><img src="/til/assets/img/07-7.ad329ec5.png" alt="img"></p> <p>분류기 에러가 0.0 에서 1.0까지 걸쳐 있을 때 앙상블의 에러율을 계산하고 그래프로 시각화하였다.</p> <p>실선이 Ensemble error이고 점선이 Base Error이다.</p> <p>개별 분류기가 무작위 추측(e &lt; 0.5)보다 성능이 좋을 때 앙상블의 에러 확률이 개별 분류기보다 좋은 것을 알 수 있다.</p> <h2 id="_7-2-다수결-투표를-사용한-분류-앙상블"><a href="#_7-2-다수결-투표를-사용한-분류-앙상블" class="header-anchor">#</a> 7.2 다수결 투표를 사용한 분류 앙상블</h2> <blockquote><p><strong>파이썬으로 간단한 다수결 투표 앙상블 분류기 구현하기!</strong></p></blockquote> <h3 id="_7-2-1-간단한-다수결-투표-분류기-구현"><a href="#_7-2-1-간단한-다수결-투표-분류기-구현" class="header-anchor">#</a> 7.2.1 간단한 다수결 투표 분류기 구현</h3> <blockquote><p>이 절에서 구현할 알고리즘은 여러 가지 분류 모델의 신뢰도에 가중치를 부여하여 연결할 수 있다.<br>
특정 데이터셋에서 개별 분류기의 약점을 보완하는 강력한 메타 분류기를 구축하는 것이 목표!</p></blockquote> <p>수학적으로 표현하면 가중치가 적용된 다수결 투표는 다음과 같다.</p> <p><img src="/til/assets/img/07-8.7809eb4f.png" alt="img"></p> <p>wj = Cj에 연관된 가중치</p> <p>y = 앙상블이 예측한 클래스 레이블</p> <p>Xa = 특성 함수(characteristic function)</p> <p>A = 고유한 클래스 레이블 집합</p> <p>가중치가 동일하면 이 식을 다음과 같이 간단히 쓸 수 있다.</p> <p><img src="/til/assets/img/07-9.088700a5.png" alt="img"></p> <blockquote><p>통계학에서 최빈값은 집합에서 가장 자주 발생하는 이벤트나 결과!<br>
예를 들어 mode{1, 2, 1, 1, 2, 4, 5, 4} = 1</p></blockquote> <p>▼ 가중치 개념</p> <p><strong>세 개의 분류기 Cj ( j ∈{0,1} )가 있고 샘플 x의 클래스 레이블을 예측</strong></p> <p>세 개의 분류기 중 두 개가 클래스 0을 예측하고 C₃ 하나가 샘플을 클래스 1로 예측하고 가중치가 동일하다면<br>
다수결 투표는 이 샘플이 클래스 0에 속한다고 예측할 것이다.</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>이제 C₃ 에 가중치 0.6을 할당 하고 나머지에 0.2를 부여해 보면</p> <p><img src="data:image/png;base64,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" alt="img"></p> <p>직관적으로 생각했을 때 3 x 0.2 = 0.6 이기 때문에 C₃의 예측이 나머지 두 개보다 예측보다 3배 더 가중된다.<br>
즉 다음과 같이 쓸 수 있다.</p> <p><img src="/til/assets/img/07-12.4a708354.png" alt="img"></p> <p>파이썬 코드로 이를 구현해보자.</p> <p><img src="/til/assets/img/07-13.50f7b0fb.png" alt="img"></p> <p>argmax와 bincount 함수를 사용하면 가중치가 적용된 다수결 투표를 구현할 수 있다.</p> <p>3장에서 로지스틱 회귀에 대해 언급했던 것처럼 사이킷런의 일부 분류기는 predict_proba 메서드에서 예측 클래스 레이블의 확률을 반환할 수 있다.</p> <p>앙상블의 분류기가 잘 보정(calibration)되어 있다면 다수결 투표에서 클래스 레이블 대신 예측 클래스 확률을 사용하는 것이 좋다.</p> <p>확률을 사용하여 클래스 레이블을 예측하는 다수결 투표 버전은 다음과 같이 쓸 수 있다.</p> <p><img src="/til/assets/img/07-14.82185b3d.png" alt="img"></p> <p><strong>Pij</strong> = 클래스 레이블 i에 대한 j번째 분류기의 예측 확률</p> <p>앞선 예제에 이어서 클래스 레이블 i ∈ { 0, 1 }인 이진 분류 문제에서 세 개의 분류기로 구성된</p> <p>앙상블 Cj( j ∈ { 1, 2, 3 }을 가정하면 어떤 샘플 x에 대한 분류기 Cj는 다음과 같은 클래스 소속 확률을 반환한다.</p> <p><img src="/til/assets/img/07-15.5450ce4d.png" alt="img"></p> <p>그다음 각 클래스 확률을 다음과 같이 계산할 수 있다.</p> <p><img src="/til/assets/img/07-16.4f343879.png" alt="img"></p> <p>넘파이의 average와 argmax 함수를 사용하여 클래스 확률 기반으로 가중치가 적용된 다수결 투표를 구현할 수 있다.</p> <p><img src="/til/assets/img/07-17.e3b04a19.png" alt="img"></p> <p>모두 결합하여 MajorityVoteClassifier 파이썬 클래스를 구현하면</p> <p><img src="/til/assets/img/07-18.290bd333.png" alt="img"><br> <img src="/til/assets/img/07-19.d53a0923.png" alt="img"></p> <p>BaseEstimator와 ClassifierMixin 클래스를 상속하여 기본적인 기능들도 상속받는다.</p> <p>get_params와 set_params 메소드가 있고 예측 정확도를 계산하는 score 메소드가 포함된다.</p> <p><img src="/til/assets/img/07-20.d4deb168.png" alt="img"><br> <img src="/til/assets/img/07-21.05e72e4e.png" alt="img"></p> <p><strong>predict 메소드</strong></p> <ul><li>vote = 'classlael' 객체 - 클래스 레이블에 기반을 둔 다수결 투표를 사용하여 클래스 레이블을 예측한다.</li> <li>vote = 'probability' 객체 - 클래스 소속 확률을 기반으로 클래스 레이블을 예측</li></ul> <p><strong>predict_proba 메소드</strong></p> <ul><li>ROC AUC를 계산하기 위해 평균 확률을 반환</li></ul> <p>앙상블에 있는 각 분류기의 매개변수에 접근하기 위해 _name_estimators 함수를 사용했고</p> <p>따로 get_params 메소드를 정의했다.</p> <blockquote><p>그리드서치를 사용하여 하이퍼 파라미터를 튜닝할 때 완전히 이해될 것이다!</p></blockquote> <h3 id="_7-2-2-다수결-투표-방식을-사용하여-예측-만들기"><a href="#_7-2-2-다수결-투표-방식을-사용하여-예측-만들기" class="header-anchor">#</a> 7.2.2 다수결 투표 방식을 사용하여 예측 만들기</h3> <blockquote><p>이제 이전 절에서 MajorityVoteClassifier 클래스를 사용한다.<br>
먼제 테스트를 위한 데이터셋을 준비한다.</p></blockquote> <p>앞서 CSV 파일에서 데이터셋을 읽는 것은 연습했고, 사이킷런의 datasets 모듈을 사용하여 붓꽃 데이터셋을 읽어 보자!</p> <p>파라미터 : 꽃받침 너비, 꽃잎 길이 두 개의 특성만 사용하여 예제 구성</p> <p><img src="/til/assets/img/07-22.f13af7fd.png" alt="img"></p> <p>붓꽃 데이터 샘플을 훈련 데이터와 테스트 데이터 50:50으로 나눈 후</p> <p>훈련 세트를 사용하여 서로 다른 세 개의 분류기를 훈련한다!</p> <ul><li>로지스틱 회귀 분류기</li> <li>결정 트리 분류기</li> <li>k-최근접 이웃 분류기</li></ul> <p>각 분류기를 앙상블로 묶기 전에 훈련 세트에서 10-겹 교차 검증으로 성능을 평가한다.</p> <p><img src="/til/assets/img/07-23.a55c7107.png" alt="img"></p> <p>출력 결과에서 볼 수 있듯이 각 분류기의 예측 성능은 거의 비슷하다.</p> <p><strong>이제 MajorityVoteClassifier 클래스로 각 분류기를 하나로 연결하자!</strong></p> <p><img src="/til/assets/img/07-24.a99f2d68.png" alt="img"></p> <p>결과에서 보듯이 10-겹 교차 검증으로 평가했을 때 <strong>MajorityVoteClassifier의 성능이 개별 분류기보다 뛰어나다</strong>.</p> <h2 id="_7-3-앙상블-분류기의-평가와-튜닝"><a href="#_7-3-앙상블-분류기의-평가와-튜닝" class="header-anchor">#</a> 7.3 앙상블 분류기의 평가와 튜닝</h2> <p>본 적 없는 데이터에 대한 MajorityVoteClassifier의 일반화 성능을 확인하기 위해 ROC 곡선을 그려본다.</p> <p><img src="/til/assets/img/07-25.fce56d36.png" alt="img"></p> <p>이 분류 문제에서는 두 개의 특성만 선택했기 때문에 앙상블의 결정 경계가 어떤 모습인지 확인이 가능하다.</p> <p><img src="/til/assets/img/07-26.b500b58f.png" alt="img"><br> <img src="/til/assets/img/07-27.6610047b.png" alt="img"></p> <p>앙상블 분류기의 결정 경계는 개별 분류기의 결정 경계를 혼합한 것처럼 보인다!</p> <p>앙상블을 위해 개별 분류기의 매개변수를 튜닝하기 전에 GridSearchCV 객체 안에 있는 매개변수에 어떻게 접근할 수 있는지 get_params 메소드를 호출해서 알아보면</p> <p><img src="/til/assets/img/07-28.dd06e357.png" alt="img"><br> <img src="/til/assets/img/07-28.dd06e357.png" alt="img"></p> <p>메소드에서 반환되는 값을 살펴보면 개별 분류기의 속성에 접근하는 방법을 알 수 있다.</p> <p><img src="/til/assets/img/07-28.dd06e357.png" alt="img"></p> <p>여기서 볼 수 있듯이 규제 강도가 가장 낮을 때 최상의 교차 검증 결과를 얻는다!</p> <h2 id="_7-3-배깅-부트스트랩-샘플링을-통한-분류-앙상블"><a href="#_7-3-배깅-부트스트랩-샘플링을-통한-분류-앙상블" class="header-anchor">#</a> 7.3 배깅 : 부트스트랩 샘플링을 통한 분류 앙상블</h2> <h3 id="_7-3-1-배깅-알고리즘의-작동-방식"><a href="#_7-3-1-배깅-알고리즘의-작동-방식" class="header-anchor">#</a> 7.3.1 배깅 알고리즘의 작동 방식</h3> <p>배깅 분류기의 부트스트랩 샘플링의 작동 방식을 확실히 이해하기 위해 그림 7-7에 나오는 예를 생각해보자.</p> <p>일곱 개의 훈련 샘플에서 배깅 단계마다 중복을 허용하여 랜덤하게 샘플링한다.</p> <p>각각의 부트스트랩 샘플을 사용하여 분류기 Cj를 학습한다.</p> <p>일반적으로 배깅 샘플 학습은 가지치기하지 않는 결정 트리를 분류기로 사용한다.
각 분류기는 훈련 세트에서 추출한 랜덤한 부분 집합을 사용하고,</p> <p>중복을 허용한 샘플링을 하기 때문에 각 부분 집합에는 일부가 중복되어 있고</p> <p>원본 샘플 중 일부는 포함되어 있지 않는다.</p> <p>개별 분류기가 부트스트랩 샘플에 학습되고 나면 다수결 투표를 사용하여 예측을 모은다.</p> <p>배깅은 3장에서 소개한 랜덤 포레스트 분류기와도 관련이 있다.
사실 랜덤포레스트는 개별 결정 트리를 학습할 때 랜덤하게 특성의 부분 집합을 선택하는
배깅의 특별한 경우이다.
7.3.2 배깅으로 Wine 데이터셋의 샘플 분류
배깅을 적용하기 위해 4장에서 소개한 Wine 데이터셋으로 좀 더 복잡한 분류 문제를 만들어보자.</p> <p>여기서는 와인 클래스 2와 클래스 3만 사용하고 두개의 특성 'Alcohol'과 'OD280/OD315 of dilutes wines'만 사용한다.</p> <p>그다음 클래스 레이블을 이진 형태로 인코딩하고 80%는 훈련 세트로 20%는 테스트 세트로 분리한다.</p> <p>사이킷런에는 BaggingClassifier 분류기가 이미 구현되어 있다!</p> <p>이 클래스는 ensemble 모듈에서 임포트할 수 있다. 여기서는 훈련 세트로부터 추출한 부트스트랩 샘플에서 가지치기가 없는 500개의 결정 트리를 학습하여 앙상블을 만들겠다.</p> <p>그다음 배깅 분류기와 가지치기가 없는 단일 결정 트리에서 훈련 세트와 테스트 세트의 예측 정확도를</p> <p>계산하여 성능을 비교한다.</p> <p>출력된 정확도 값을 보면 가지치기가 없는 결정 트리는 모든 훈련 샘플을 정확하게 예측했다.</p> <p>테스트 정확도는 확실히 낮기 때문에 모델의 분산이 높다는 것(과대적합)을 나타낸다.</p> <p>결정 트리와 배깅 분류기의 훈련 정확도가 훈련 세트에서 비슷하지만 테스트 세트의 정확도로 미루어 보아 배깅 분류기가 일반화 성능이 더 나을 것 같다.</p> <p>결정트리와 배깅 분류기의 결정 경계를 비교해 보자.</p> <p>결과 그래프에서 보듯이 결정 트리의 선형 결정 경계가 배깅 앙상블에서 더 부드러워졌다!</p> <p>더 복잡한 분류 문제에서 단일 결정 트리가 쉽게 과대적합될 수 있다.</p> <p>이런 경우에 배깅 알고리즘이 더 강력하게 적용될 것이다!</p> <p>하지만 배깅 알고리즘은 모델의 분산을 감소하는 효과적인 방법이지만 모델의 편향을 낮추는 데는 효과적이지 않다.</p> <p>모델이 너무 단순해서 데이터에 있는 경향을 잘 잡아내지 못한다.</p> <p>이것이 배깅을 수행할 때 편향이 낮은 모델, 예를 들어 가지치기하지 않은 결정 트리를 분류기로 사용하여 앙상블을 만드는 이유다.</p> <p><img src="/til/assets/img/07-28.dd06e357.png" alt="img"></p> <h2 id="_7-4-약한-학습기를-이용한-에이다부스트"><a href="#_7-4-약한-학습기를-이용한-에이다부스트" class="header-anchor">#</a> 7.4 약한 학습기를 이용한 에이다부스트</h2> <p>부스팅(boosting) 중 에이다부스트는 오차로부터 점진적으로 학습하는 약한 학습기를 기반으로 하는 알고리즘</p> <p>랜덤 추측보다 조금 성능이 좋을 뿐이다.</p> <p><img src="/til/assets/img/07-28.dd06e357.png" alt="img"></p> <h2 id="_7-5-요약"><a href="#_7-5-요약" class="header-anchor">#</a> 7.5 요약</h2> <blockquote><p><strong>앙상블 학습의 기법 3가지</strong></p></blockquote> <p>이 장에서 가장 인기 있고 널리 사용되는 앙상블 학습의 기법을 살펴보았다.</p> <p>앙상블 방법은 개별 분류기의 약점을 보완하기 위해 다양한 모델을 결합한다.</p> <p>머신 러닝 경연 대회는 물론 현업 애플리케이션을 위해서도 안정적이고 성능이 높은 모델을 만들 수 있어 매력적이다!</p> <p>MajorityVoteClassifier 파이썬 클래스를 구현 : 다양한 분류 알고리즘을 결합할 수 있음</p> <p>배깅 : 훈련 세트에서 랜덤한 부트스트랩 샘플을 추출하고 다수결 투표를 통해 훈련된 개별 분류기를 결합함으로써</p> <p>모델의 분산을 감소시키는 기법</p> <p>에이다부스트 : 오차로부터 점진적으로 학습하는 약한 학습기를 기반으로 하는 알고리즘</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/22/2021, 9:15:18 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/til/machine-learning/02.간단한-분류-알고리즘-훈련.html" class="prev">
        2장 간단한 분류 알고리즘 훈련
      </a></span> <span class="next"><a href="/til/machine-learning/colab-github-demo.html">
        Using Colab with GitHub
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/til/assets/js/app.db613388.js" defer></script><script src="/til/assets/js/2.f827bc55.js" defer></script><script src="/til/assets/js/3.523a327b.js" defer></script><script src="/til/assets/js/46.01e6df54.js" defer></script>
  </body>
</html>
